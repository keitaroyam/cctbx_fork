from __future__ import division

from libtbx.utils import null_out
from cStringIO import StringIO
from mmtbx.secondary_structure.find_ss_from_ca import find_secondary_structure

def remove_blank(text):
  return text.replace(" ","").replace("\n","")

def tst_01():
  text="""
ATOM      1  N   GLY U  11     -20.099   8.864  10.230  1.00 52.86           N
ATOM      2  CA  GLY U  11     -19.400   7.571   9.992  1.00 52.86           C
ATOM      3  C   GLY U  11     -17.867   8.054   9.511  1.00 52.86           C
ATOM      4  O   GLY U  11     -18.033   8.077   8.293  1.00 52.86           O
ATOM      5  N   GLY U  12     -16.673   8.172  10.087  1.00 52.86           N
ATOM      6  CA  GLY U  12     -15.517   7.978   9.123  1.00 52.86           C
ATOM      7  C   GLY U  12     -15.338   6.468   9.675  1.00 52.86           C
ATOM      8  O   GLY U  12     -15.070   5.904  10.738  1.00 52.86           O
ATOM      9  N   GLY U  13     -15.479   5.785   8.520  1.00 52.86           N
ATOM     10  CA  GLY U  13     -14.900   4.879   9.412  1.00 52.86           C
ATOM     11  C   GLY U  13     -14.424   3.514   9.380  1.00 52.86           C
ATOM     12  O   GLY U  13     -13.660   2.944   8.602  1.00 52.86           O
ATOM     13  N   GLY U  14     -14.286   3.425  10.715  1.00 52.86           N
ATOM     14  CA  GLY U  14     -13.338   2.264  10.393  1.00 52.86           C
ATOM     15  C   GLY U  14     -12.091   1.361   9.704  1.00 52.86           C
ATOM     16  O   GLY U  14     -11.343   0.974   8.806  1.00 52.86           O
ATOM     17  N   GLY U  15     -12.859   0.538  10.412  1.00 52.86           N
ATOM     18  CA  GLY U  15     -12.030  -0.556  10.373  1.00 52.86           C
ATOM     19  C   GLY U  15     -12.456  -1.530   9.072  1.00 52.86           C
ATOM     20  O   GLY U  15     -13.665  -1.682   8.859  1.00 52.86           O
ATOM     21  N   GLY U  16     -11.909  -3.009   7.572  1.00 42.55           N
ATOM     22  CA  GLY U  16     -11.031  -3.180   6.040  1.00 42.55           C
ATOM     23  C   GLY U  16     -10.265  -3.837   5.718  1.00 42.55           C
ATOM     24  O   GLY U  16      -9.515  -4.299   6.577  1.00 42.55           O
ATOM     25  N   GLY U  17     -11.247  -3.944   5.165  1.00 52.86           N
ATOM     26  CA  GLY U  17     -10.273  -5.222   4.456  1.00 52.86           C
ATOM     27  C   GLY U  17      -9.735  -4.585   3.332  1.00 52.86           C
ATOM     28  O   GLY U  17     -10.280  -3.765   2.596  1.00 52.86           O
ATOM     29  N   GLY U  18      -8.496  -4.996   3.135  1.00 52.86           N
ATOM     30  CA  GLY U  18      -8.015  -4.822   2.186  1.00 52.86           C
ATOM     31  C   GLY U  18      -7.002  -5.187   1.126  1.00 52.86           C
ATOM     32  O   GLY U  18      -6.107  -5.649   1.834  1.00 52.86           O
ATOM     33  N   GLY U  19      -7.061  -5.398  -0.184  1.00 52.86           N
ATOM     34  CA  GLY U  19      -6.009  -6.212  -0.948  1.00 52.86           C
ATOM     35  C   GLY U  19      -4.828  -5.254  -1.458  1.00 52.86           C
ATOM     36  O   GLY U  19      -5.131  -4.184  -1.991  1.00 52.86           O
ATOM     37  N   GLY U  20      -3.582  -5.721  -1.443  1.00 52.86           N
ATOM     38  CA  GLY U  20      -2.729  -4.680  -2.268  1.00 52.86           C
ATOM     39  C   GLY U  20      -2.086  -4.815  -3.421  1.00 52.86           C
ATOM     40  O   GLY U  20      -1.108  -5.401  -3.871  1.00 52.86           O
ATOM     41  N   GLY U  21      -2.755  -3.911  -4.145  1.00 52.86           N
ATOM     42  CA  GLY U  21      -2.425  -3.693  -5.384  1.00 52.86           C
ATOM     43  C   GLY U  21      -0.789  -3.646  -5.564  1.00 52.86           C
ATOM     44  O   GLY U  21      -0.196  -4.136  -6.539  1.00 52.86           O
"""
  print "Finding beta strands...",
  import iotbx.pdb
  from cctbx.array_family import flex
  hierarchy=iotbx.pdb.input(source_info='text',
       lines=flex.split_lines(text)).construct_hierarchy()
  fss=find_secondary_structure(args=['include_single=True'],hierarchy=hierarchy,out=null_out())

  expected_text="""
Model 1  N: 11  Start: 11 End: 21
Class:  Beta strand  N: 4 Start: 12 End: 15  Rise: 3.12 A Dot: 1.00
Class:  Beta strand  N: 5 Start: 17 End: 21  Rise: 3.35 A Dot: 0.96

PDB RECORDS:
SHEET    1   1 1 GLY U  12  GLY U  15  0
SHEET    1   2 1 GLY U  17  GLY U  21  0

PDB Selections:
" ( chain 'U' and resseq 12:15 and icode ' ')  or  ( chain 'U' and resseq 17:21 and icode ' ') "

"""
  f=StringIO()
  fss.show_summary(out=f,verbose=True)
  found_text=f.getvalue()
  if remove_blank(found_text)!=remove_blank(expected_text):
    print "Expected: \n%s \nFound: \n%s" %(expected_text,found_text)
    raise AssertionError, "FAILED"
  print "OK"


def tst_02():
  text="""
ATOM      1  N   GLY A   1      42.375 -12.180  24.780  1.00 35.31
ATOM      2  CA  GLY A   1      43.603 -11.488  24.325  1.00 35.57
ATOM      3  C   GLY A   1      43.288 -10.171  23.615  1.00 34.64
ATOM      4  O   GLY A   1      42.111  -9.896  23.277  1.00 35.82
ATOM      5  N   ILE A   2      44.323  -9.391  23.299  1.00 32.23
ATOM      6  CA  ILE A   2      44.200  -8.183  22.475  1.00 27.55
ATOM      7  C   ILE A   2      43.750  -8.629  21.119  1.00 24.92
ATOM      8  O   ILE A   2      43.068  -7.904  20.409  1.00 23.73
ATOM      9  CB  ILE A   2      45.525  -7.320  22.425  1.00 30.10
ATOM     10  CG1 ILE A   2      45.924  -6.837  23.820  1.00 29.64
ATOM     11  CG2 ILE A   2      45.555  -6.173  21.386  1.00 30.54
ATOM     12  CD1 ILE A   2      44.837  -6.338  24.762  1.00 32.44
ATOM     13  N   GLY A   3      44.161  -9.867  20.749  1.00 22.69
ATOM     14  CA  GLY A   3      43.999 -10.264  19.329  1.00 21.05
ATOM     15  C   GLY A   3      42.433 -10.405  19.166  1.00 22.08
ATOM     16  O   GLY A   3      41.912 -10.061  18.096  1.00 22.86
ATOM     17  N   ALA A   4      41.862 -10.961  20.191  1.00 21.60
ATOM     18  CA  ALA A   4      40.378 -11.260  20.106  1.00 21.80
ATOM     19  C   ALA A   4      39.584  -9.950  20.087  1.00 21.67
ATOM     20  O   ALA A   4      38.676  -9.747  19.278  1.00 22.21
ATOM     21  CB  ALA A   4      40.061 -12.080  21.350  1.00 22.97
ATOM     22  N   VAL A   5      39.936  -9.001  20.956  1.00 22.13
ATOM     23  CA  VAL A   5      39.355  -7.658  21.083  1.00 19.34
ATOM     24  C   VAL A   5      39.536  -6.896  19.795  1.00 18.81
ATOM     25  O   VAL A   5      38.626  -6.314  19.126  1.00 17.22
ATOM     26  CB  VAL A   5      39.843  -6.933  22.338  1.00 20.40
ATOM     27  CG1 VAL A   5      39.237  -5.519  22.413  1.00 23.06
ATOM     28  CG2 VAL A   5      39.745  -7.587  23.653  1.00 21.67
ATOM     29  N   LEU A   6      40.752  -7.021  19.222  1.00 16.05
ATOM     30  CA  LEU A   6      41.062  -6.432  17.957  1.00 17.59
ATOM     31  C   LEU A   6      40.230  -6.935  16.870  1.00 20.01
ATOM     32  O   LEU A   6      39.649  -6.121  16.029  1.00 21.90
ATOM     33  CB  LEU A   6      42.627  -6.461  17.880  1.00 24.58
ATOM     34  CG  LEU A   6      43.125  -6.023  16.524  1.00 23.91
ATOM     35  CD1 LEU A   6      42.706  -4.584  16.210  1.00 27.44
ATOM     36  CD2 LEU A   6      44.669  -6.152  16.638  1.00 29.31
ATOM     37  N   LYS A   7      39.981  -8.229  16.721  1.00 19.83
ATOM     38  CA  LYS A   7      39.079  -8.646  15.636  1.00 22.55
ATOM     39  C   LYS A   7      37.648  -8.063  15.784  1.00 19.04
ATOM     40  O   LYS A   7      37.031  -7.839  14.731  1.00 21.18
ATOM     41  CB  LYS A   7      38.854 -10.176  15.616  1.00 27.62
ATOM     42  CG  LYS A   7      40.011 -10.993  15.144  1.00 40.15
ATOM     43  CD  LYS A   7      39.691 -12.487  15.325  1.00 47.84
ATOM     44  CE  LYS A   7      40.599 -13.394  14.493  1.00 53.11
ATOM     45  NZ  LYS A   7      39.966 -14.755  14.319  1.00 55.47
ATOM     46  N   VAL A   8      37.111  -7.988  16.981  1.00 19.69
ATOM     47  CA  VAL A   8      35.792  -7.369  17.211  1.00 20.52
ATOM     48  C   VAL A   8      35.776  -5.881  16.885  1.00 20.31
ATOM     49  O   VAL A   8      34.775  -5.402  16.257  1.00 20.12
ATOM     50  CB  VAL A   8      35.113  -7.600  18.562  1.00 23.09
ATOM     51  CG1 VAL A   8      34.774  -9.045  18.851  1.00 24.22
ATOM     52  CG2 VAL A   8      35.769  -6.970  19.726  1.00 27.95
ATOM     68  N   THR A  11      35.315  -5.870  13.113  1.00 21.12
ATOM     69  CA  THR A  11      34.132  -6.405  12.343  1.00 24.14
ATOM     70  C   THR A  11      32.874  -6.299  13.140  1.00 24.13
ATOM     71  O   THR A  11      31.823  -5.889  12.630  1.00 27.78
ATOM     72  CB  THR A  11      34.462  -7.925  11.935  1.00 27.78
ATOM     73  OG1 THR A  11      34.702  -8.591  13.199  1.00 31.22
ATOM     74  CG2 THR A  11      35.695  -7.959  11.047  1.00 30.31
ATOM     75  N   GLY A  12      32.918  -6.606  14.420  1.00 23.00
ATOM     76  CA  GLY A  12      31.584  -6.595  15.140  1.00 24.17
ATOM     77  C   GLY A  12      31.264  -5.168  15.584  1.00 24.45
ATOM     78  O   GLY A  12      30.060  -4.914  15.603  1.00 23.79
ATOM     79  N   LEU A  13      32.195  -4.276  15.948  1.00 22.05
ATOM     80  CA  LEU A  13      31.923  -2.919  16.364  1.00 23.24
ATOM     81  C   LEU A  13      31.251  -2.004  15.324  1.00 21.24
ATOM     82  O   LEU A  13      30.232  -1.308  15.679  1.00 23.02
ATOM     83  CB  LEU A  13      33.146  -2.183  17.008  1.00 25.55
ATOM     84  CG  LEU A  13      32.913  -1.523  18.351  1.00 27.01
ATOM     85  CD1 LEU A  13      33.999  -0.517  18.760  1.00 27.53
ATOM     86  CD2 LEU A  13      31.587  -0.842  18.531  1.00 24.54
ATOM     87  N   PRO A  14      31.689  -1.979  14.106  1.00 17.38
ATOM     88  CA  PRO A  14      31.026  -1.278  13.030  1.00 17.52
ATOM     89  C   PRO A  14      29.521  -1.670  12.857  1.00 18.98
ATOM     90  O   PRO A  14      28.657  -0.801  12.744  1.00 16.75
ATOM     91  CB  PRO A  14      31.845  -1.614  11.816  1.00 17.80
ATOM     92  CG  PRO A  14      33.118  -2.205  12.303  1.00 18.05
ATOM     93  CD  PRO A  14      33.098  -2.363  13.769  1.00 17.96
ATOM     94  N   ALA A  15      29.207  -2.952  12.868  1.00 16.39
ATOM     95  CA  ALA A  15      27.822  -3.418  12.724  1.00 17.10
ATOM     96  C   ALA A  15      27.023  -3.016  13.951  1.00 16.98
ATOM     97  O   ALA A  15      25.872  -2.551  13.769  1.00 16.78
ATOM     98  CB  ALA A  15      27.741  -4.906  12.502  1.00 19.58
ATOM     99  N   LEU A  16      27.570  -3.117  15.127  1.00 15.97
ATOM    100  CA  LEU A  16      26.958  -2.649  16.351  1.00 18.20
ATOM    101  C   LEU A  16      26.614  -1.169  16.344  1.00 20.28
ATOM    102  O   LEU A  16      25.599  -0.734  16.933  1.00 18.32
ATOM    103  CB  LEU A  16      27.811  -3.027  17.542  1.00 19.70
ATOM    104  CG  LEU A  16      27.384  -2.550  18.921  1.00 22.23
ATOM    105  CD1 LEU A  16      26.031  -3.234  19.257  1.00 27.80
ATOM    106  CD2 LEU A  16      28.445  -2.970  19.933  1.00 21.91
ATOM    107  N   ILE A  17      27.514  -0.365  15.791  1.00 20.97
ATOM    108  CA  ILE A  17      27.343   1.056  15.618  1.00 20.41
ATOM    109  C   ILE A  17      26.081   1.392  14.758  1.00 18.17
ATOM    110  O   ILE A  17      25.380   2.240  15.282  1.00 16.46
ATOM    111  CB  ILE A  17      28.579   1.847  15.132  1.00 21.10
ATOM    112  CG1 ILE A  17      29.586   1.858  16.352  1.00 25.66
ATOM    113  CG2 ILE A  17      28.268   3.288  14.691  1.00 22.04
ATOM    114  CD1 ILE A  17      30.856   2.696  16.161  1.00 27.00
ATOM    115  N   SER A  18      25.930   0.759  13.657  1.00 16.97
ATOM    116  CA  SER A  18      24.825   0.827  12.744  1.00 19.98
ATOM    117  C   SER A  18      23.499   0.405  13.438  1.00 18.89
ATOM    118  O   SER A  18      22.557   1.165  13.352  1.00 18.37
ATOM    119  CB  SER A  18      25.076   0.039  11.491  1.00 20.39
ATOM    120  OG  SER A  18      23.902   0.046  10.670  1.00 23.87
ATOM    121  N   TRP A  19      23.512  -0.661  14.161  1.00 17.71
ATOM    122  CA  TRP A  19      22.492  -1.085  15.081  1.00 15.72
ATOM    123  C   TRP A  19      22.083   0.004  16.012  1.00 18.02
ATOM    124  O   TRP A  19      20.820   0.244  16.160  1.00 16.93
ATOM    125  CB  TRP A  19      22.854  -2.410  15.767  1.00 15.59
ATOM    126  CG  TRP A  19      21.803  -2.993  16.678  1.00 17.94
ATOM    127  CD1 TRP A  19      20.917  -3.950  16.210  1.00 18.03
ATOM    128  CD2 TRP A  19      21.448  -2.745  18.041  1.00 16.03
ATOM    129  NE1 TRP A  19      20.060  -4.304  17.222  1.00 21.28
ATOM    130  CE2 TRP A  19      20.357  -3.624  18.372  1.00 20.45
ATOM    131  CE3 TRP A  19      21.879  -1.892  19.048  1.00 14.41
ATOM    132  CZ2 TRP A  19      19.784  -3.690  19.612  1.00 17.15
ATOM    133  CZ3 TRP A  19      21.292  -1.950  20.288  1.00 17.24
ATOM    134  CH2 TRP A  19      20.230  -2.805  20.601  1.00 15.13
ATOM    135  N   ILE A  20      22.930   0.594  16.823  1.00 14.82
ATOM    136  CA  ILE A  20      22.628   1.633  17.766  1.00 15.67
ATOM    137  C   ILE A  20      21.917   2.819  17.080  1.00 17.51
ATOM    138  O   ILE A  20      20.942   3.365  17.655  1.00 17.70
ATOM    139  CB  ILE A  20      23.902   2.192  18.499  1.00 16.25
ATOM    140  CG1 ILE A  20      24.481   0.986  19.363  1.00 15.50
ATOM    141  CG2 ILE A  20      23.599   3.421  19.390  1.00 14.54
ATOM    142  CD1 ILE A  20      26.033   1.304  19.637  1.00 18.18
ATOM    143  N   LYS A  21      22.464   3.177  15.957  1.00 16.61
ATOM    144  CA  LYS A  21      21.888   4.236  15.157  1.00 19.84
ATOM    145  C   LYS A  21      20.436   3.910  14.752  1.00 21.02
ATOM    146  O   LYS A  21      19.685   4.899  14.971  1.00 22.80
ATOM    147  CB  LYS A  21      22.699   4.646  13.935  1.00 16.73
ATOM    148  CG  LYS A  21      23.944   5.416  14.471  1.00 22.19
ATOM    149  CD  LYS A  21      24.919   5.669  13.300  1.00 25.86
ATOM    150  CE  LYS A  21      26.173   6.287  13.908  1.00 32.91
ATOM    151  NZ  LYS A  21      27.199   6.564  12.863  1.00 39.11
ATOM    152  N   ARG A  22      20.075   2.728  14.351  1.00 19.18
ATOM    153  CA  ARG A  22      18.740   2.273  14.020  1.00 20.38
ATOM    154  C   ARG A  22      17.807   2.365  15.177  1.00 22.46
ATOM    155  O   ARG A  22      16.648   2.899  15.096  1.00 23.24
ATOM    156  CB  ARG A  22      18.733   0.860  13.418  1.00 22.73
ATOM    157  CG  ARG A  22      19.309   0.956  12.004  1.00 22.29
ATOM    158  CD  ARG A  22      19.117  -0.300  11.254  1.00 25.78
ATOM    159  NE  ARG A  22      19.382  -1.562  11.991  1.00 28.94
ATOM    160  CZ  ARG A  22      20.624  -2.104  11.889  1.00 33.77
ATOM    161  NH1 ARG A  22      21.664  -1.554  11.252  1.00 31.21
ATOM    162  NH2 ARG A  22      20.870  -3.271  12.498  1.00 33.11
ATOM    163  N   LYS A  23      18.257   1.937  16.323  1.00 20.49
ATOM    164  CA  LYS A  23      17.500   1.928  17.550  1.00 22.62
ATOM    165  C   LYS A  23      17.216   3.361  18.100  1.00 25.47
ATOM    166  O   LYS A  23      16.204   3.554  18.811  1.00 24.62
ATOM    167  CB  LYS A  23      18.257   1.128  18.589  1.00 24.16
ATOM    168  CG  LYS A  23      17.979  -0.388  18.463  1.00 31.03
ATOM    169  CD  LYS A  23      16.858  -0.657  19.514  1.00 38.52
ATOM    170  CE  LYS A  23      16.197  -1.986  19.278  1.00 44.05
ATOM    171  NZ  LYS A  23      15.412  -2.493  20.477  1.00 48.30
ATOM    172  N   ARG A  24      18.155   4.268  17.844  1.00 23.99
ATOM    173  CA  ARG A  24      18.059   5.674  18.276  1.00 27.11
ATOM    174  C   ARG A  24      16.996   6.355  17.441  1.00 28.34
ATOM    175  O   ARG A  24      16.224   7.166  18.029  1.00 31.82
ATOM    176  CB  ARG A  24      19.446   6.379  18.188  1.00 22.24
ATOM    177  CG  ARG A  24      20.182   6.236  19.542  1.00 20.01
ATOM    178  CD  ARG A  24      21.577   6.742  19.433  1.00 25.00
ATOM    179  NE  ARG A  24      21.715   8.115  18.950  1.00 24.24
ATOM    180  CZ  ARG A  24      21.745   9.136  19.837  1.00 22.72
ATOM    181  NH1 ARG A  24      21.508   8.848  21.086  1.00 24.10
ATOM    182  NH2 ARG A  24      22.134  10.375  19.512  1.00 24.09
ATOM    183  N   GLN A  25      16.889   6.080  16.192  1.00 29.90
ATOM    184  CA  GLN A  25      15.836   6.730  15.339  1.00 37.50
ATOM    185  C   GLN A  25      14.463   6.162  15.554  1.00 39.92
ATOM    186  O   GLN A  25      13.435   6.799  15.227  1.00 42.39
ATOM    187  CB  GLN A  25      16.283   6.713  13.874  1.00 40.82
ATOM    188  CG  GLN A  25      17.607   7.505  13.800  1.00 46.91
ATOM    189  CD  GLN A  25      18.413   7.205  12.564  1.00 50.89
ATOM    190  OE1 GLN A  25      19.596   7.559  12.477  1.00 54.23
ATOM    191  NE2 GLN A  25      17.757   6.512  11.624  1.00 51.61
ATOM    192  N   GLN A  26      14.363   4.945  16.064  1.00 43.06
ATOM    193  CA  GLN A  26      13.132   4.360  16.583  1.00 46.66
ATOM    194  C   GLN A  26      12.618   5.071  17.837  1.00 48.00
ATOM    195  O   GLN A  26      11.409   5.344  17.597  1.00 50.85
ATOM    196  CB  GLN A  26      13.144   2.874  16.862  1.00 49.14
ATOM    197  CG  GLN A  26      13.166   1.972  15.625  1.00 54.49
ATOM    198  CD  GLN A  26      13.506   0.551  16.116  1.00 58.10
ATOM    199  OE1 GLN A  26      13.083   0.180  17.239  1.00 59.27
ATOM    200  NE2 GLN A  26      14.304  -0.117  15.290  1.00 57.61
"""
  print "Finding helices...",
  import iotbx.pdb
  from cctbx.array_family import flex
  hierarchy=iotbx.pdb.input(source_info='text',
       lines=flex.split_lines(text)).construct_hierarchy()
  fss=find_secondary_structure(hierarchy=hierarchy,out=null_out())

  expected_text="""
Model 1  N: 8  Start: 1 End: 8
Class:  Alpha helix  N: 8 Start: 1 End: 8  Rise: 1.56 A Dot: 0.98

Model 2  N: 16  Start: 11 End: 26
Class:  Alpha helix  N: 16 Start: 11 End: 26  Rise: 1.58 A Dot: 0.98

PDB RECORDS:
HELIX    1   1 GLY A    1  VAL A    8  1                                   8
HELIX    2   2 THR A   11  GLN A   26  1                                  16

PDB Selections:
" ( chain 'A' and resseq 1:8 and icode ' ')  or  ( chain 'A' and resseq 11:26 and icode ' ') "

"""
  f=StringIO()
  fss.show_summary(out=f,verbose=True)
  found_text=f.getvalue()
  if remove_blank(found_text)!=remove_blank(expected_text):
    print "Expected: \n%s \nFound: \n%s" %(expected_text,found_text)
    raise AssertionError, "FAILED"
  print "OK"

def tst_03():
  text="""
ATOM      1  N   ALA A   1      11.622  32.477  10.274  1.00 40.00           N
ATOM      2  CA  ALA A   1      11.323  32.055  11.635  1.00 40.00           C
ATOM      3  C   ALA A   1      10.442  30.808  11.656  1.00 40.00           C
ATOM      4  O   ALA A   1      10.848  29.796  12.227  1.00 40.00           O
ATOM      5  CB  ALA A   1      10.675  33.191  12.414  1.00 40.00           C
ATOM      6  N   ALA A   2       9.256  30.870  11.012  1.00 40.00           N
ATOM      7  CA  ALA A   2       8.288  29.768  10.916  1.00 40.00           C
ATOM      8  C   ALA A   2       8.847  28.573  10.125  1.00 40.00           C
ATOM      9  O   ALA A   2       8.553  27.422  10.462  1.00 40.00           O
ATOM     10  CB  ALA A   2       7.000  30.267  10.276  1.00 40.00           C
ATOM     11  N   ALA A   3       9.664  28.856   9.084  1.00 40.00           N
ATOM     12  CA  ALA A   3      10.313  27.854   8.231  1.00 40.00           C
ATOM     13  C   ALA A   3      11.391  27.082   8.994  1.00 40.00           C
ATOM     14  O   ALA A   3      11.616  25.906   8.687  1.00 40.00           O
ATOM     15  CB  ALA A   3      10.915  28.517   7.000  1.00 40.00           C
ATOM     16  N   ALA A   4      12.063  27.744   9.976  1.00 40.00           N
ATOM     17  CA  ALA A   4      13.089  27.116  10.822  1.00 40.00           C
ATOM     18  C   ALA A   4      12.441  26.043  11.703  1.00 40.00           C
ATOM     19  O   ALA A   4      12.888  24.897  11.671  1.00 40.00           O
ATOM     20  CB  ALA A   4      13.785  28.160  11.683  1.00 40.00           C
ATOM     21  N   ALA A   5      11.338  26.398  12.423  1.00 40.00           N
ATOM     22  CA  ALA A   5      10.573  25.488  13.298  1.00 40.00           C
ATOM     23  C   ALA A   5      10.042  24.288  12.513  1.00 40.00           C
ATOM     24  O   ALA A   5       9.981  23.179  13.048  1.00 40.00           O
ATOM     25  CB  ALA A   5       9.433  26.233  13.975  1.00 40.00           C
ATOM     26  N   ALA A   6       9.715  24.518  11.221  1.00 40.00           N
ATOM     27  CA  ALA A   6       9.258  23.514  10.260  1.00 40.00           C
ATOM     28  C   ALA A   6      10.440  22.620   9.865  1.00 40.00           C
ATOM     29  O   ALA A   6      10.361  21.405  10.060  1.00 40.00           O
ATOM     30  CB  ALA A   6       8.664  24.193   9.032  1.00 40.00           C
ATOM     31  N   ALA A   7      11.556  23.234   9.374  1.00 40.00           N
ATOM     32  CA  ALA A   7      12.788  22.543   8.962  1.00 40.00           C
ATOM     33  C   ALA A   7      13.411  21.694  10.075  1.00 40.00           C
ATOM     34  O   ALA A   7      13.954  20.625   9.782  1.00 40.00           O
ATOM     35  CB  ALA A   7      13.806  23.540   8.433  1.00 40.00           C
ATOM     36  N   ALA A   8      13.327  22.168  11.343  1.00 40.00           N
ATOM     37  CA  ALA A   8      13.846  21.459  12.515  1.00 40.00           C
ATOM     38  C   ALA A   8      13.009  20.197  12.768  1.00 40.00           C
ATOM     39  O   ALA A   8      13.568  19.097  12.858  1.00 40.00           O
ATOM     40  CB  ALA A   8      13.833  22.368  13.742  1.00 40.00           C
ATOM     41  N   ALA A   9      11.664  20.357  12.803  1.00 40.00           N
ATOM     42  CA  ALA A   9      10.716  19.261  12.994  1.00 40.00           C
ATOM     43  C   ALA A   9      10.754  18.279  11.822  1.00 40.00           C
ATOM     44  O   ALA A   9      10.654  17.075  12.051  1.00 40.00           O
ATOM     45  CB  ALA A   9       9.314  19.805  13.193  1.00 40.00           C
ATOM     46  N   ALA A  10      10.942  18.791  10.578  1.00 40.00           N
ATOM     47  CA  ALA A  10      11.063  17.985   9.357  1.00 40.00           C
ATOM     48  C   ALA A  10      12.322  17.116   9.421  1.00 40.00           C
ATOM     49  O   ALA A  10      12.235  15.910   9.169  1.00 40.00           O
ATOM     50  CB  ALA A  10      11.105  18.881   8.130  1.00 40.00           C
ATOM     51  N   ALA A  11      13.480  17.722   9.803  1.00 40.00           N
ATOM     52  CA  ALA A  11      14.754  17.018   9.967  1.00 40.00           C
ATOM     53  C   ALA A  11      14.631  15.976  11.089  1.00 40.00           C
ATOM     54  O   ALA A  11      15.074  14.837  10.908  1.00 40.00           O
ATOM     55  CB  ALA A  11      15.870  18.004  10.279  1.00 40.00           C
ATOM     56  N   ALA A  12      13.972  16.356  12.217  1.00 40.00           N
ATOM     57  CA  ALA A  12      13.721  15.483  13.371  1.00 40.00           C
ATOM     58  C   ALA A  12      12.851  14.277  12.972  1.00 40.00           C
ATOM     59  O   ALA A  12      13.201  13.140  13.310  1.00 40.00           O
ATOM     60  CB  ALA A  12      13.052  16.269  14.490  1.00 40.00           C
ATOM     61  N   ALA A  13      11.748  14.535  12.215  1.00 40.00           N
ATOM     62  CA  ALA A  13      10.821  13.516  11.708  1.00 40.00           C
ATOM     63  C   ALA A  13      11.530  12.563  10.752  1.00 40.00           C
ATOM     64  O   ALA A  13      11.266  11.360  10.793  1.00 40.00           O
ATOM     65  CB  ALA A  13       9.636  14.173  11.008  1.00 40.00           C
ATOM     66  N   ALA A  14      12.437  13.112   9.903  1.00 40.00           N
ATOM     67  CA  ALA A  14      13.246  12.367   8.939  1.00 40.00           C
ATOM     68  C   ALA A  14      14.277  11.511   9.676  1.00 40.00           C
ATOM     69  O   ALA A  14      14.512  10.363   9.286  1.00 40.00           O
ATOM     70  CB  ALA A  14      13.942  13.329   7.986  1.00 40.00           C
ATOM     71  N   ALA A  15      14.863  12.069  10.767  1.00 40.00           N
ATOM     72  CA  ALA A  15      15.847  11.407  11.629  1.00 40.00           C
ATOM     73  C   ALA A  15      15.213  10.257  12.427  1.00 40.00           C
ATOM     74  O   ALA A  15      15.922   9.322  12.816  1.00 40.00           O
ATOM     75  CB  ALA A  15      16.475  12.418  12.573  1.00 40.00           C
ATOM     76  N   ALA A  16      13.879  10.325  12.652  1.00 40.00           N
ATOM     77  CA  ALA A  16      13.099   9.317  13.370  1.00 40.00           C
ATOM     78  C   ALA A  16      12.822   8.106  12.488  1.00 40.00           C
ATOM     79  O   ALA A  16      12.658   7.000  12.999  1.00 40.00           O
ATOM     80  CB  ALA A  16      11.790   9.918  13.852  1.00 40.00           C
ATOM      1  N   ALA B   2       2.054  -2.383  -1.604  1.00  1.00
ATOM      2  CA  ALA B   2       1.733  -3.620  -2.296  1.00  1.00
ATOM      3  CB  ALA B   2       2.324  -4.804  -1.527  1.00  1.00
ATOM      4  C   ALA B   2       0.216  -3.730  -2.460  1.00  1.00
ATOM      5  O   ALA B   2      -0.301  -3.624  -3.570  1.00  1.00
ATOM      6  N   ALA B   3      -0.454  -3.940  -1.336  1.00  1.00
ATOM      7  CA  ALA B   3      -1.902  -4.065  -1.341  1.00  1.00
ATOM      8  CB  ALA B   3      -2.398  -4.316   0.085  1.00  1.00
ATOM      9  C   ALA B   3      -2.516  -2.807  -1.959  1.00  1.00
ATOM     10  O   ALA B   3      -3.064  -2.855  -3.059  1.00  1.00
ATOM     11  N   ALA B   4      -2.404  -1.710  -1.223  1.00  1.00
ATOM     12  CA  ALA B   4      -2.941  -0.441  -1.685  1.00  1.00
ATOM     13  CB  ALA B   4      -2.681   0.637  -0.632  1.00  1.00
ATOM     14  C   ALA B   4      -2.323  -0.094  -3.041  1.00  1.00
ATOM     15  O   ALA B   4      -3.006  -0.121  -4.063  1.00  1.00
ATOM     16  N   ALA B   5      -1.038   0.226  -3.004  1.00  1.00
ATOM     17  CA  ALA B   5      -0.320   0.578  -4.218  1.00  1.00
ATOM     18  CB  ALA B   5       1.133   0.912  -3.873  1.00  1.00
ATOM     19  C   ALA B   5      -0.432  -0.570  -5.223  1.00  1.00
ATOM     20  O   ALA B   5      -1.103  -0.441  -6.246  1.00  1.00
ATOM     21  N   ALA B   6       0.236  -1.666  -4.897  1.00  1.00
ATOM     22  CA  ALA B   6       0.221  -2.836  -5.759  1.00  1.00
ATOM     23  CB  ALA B   6       1.085  -3.937  -5.142  1.00  1.00
ATOM     24  C   ALA B   6      -1.226  -3.284  -5.977  1.00  1.00
ATOM     25  O   ALA B   6      -1.761  -3.154  -7.077  1.00  1.00
ATOM     26  N   ALA B   7      -1.818  -3.803  -4.912  1.00  1.00
ATOM     27  CA  ALA B   7      -3.192  -4.271  -4.973  1.00  1.00
ATOM     28  CB  ALA B   7      -3.603  -4.829  -3.609  1.00  1.00
ATOM     29  C   ALA B   7      -4.097  -3.125  -5.430  1.00  1.00
ATOM     30  O   ALA B   7      -4.624  -3.151  -6.541  1.00  1.00
ATOM     31  N   ALA B   8      -4.249  -2.146  -4.550  1.00  1.00
ATOM     32  CA  ALA B   8      -5.081  -0.993  -4.849  1.00  1.00
ATOM     33  CB  ALA B   8      -5.083  -0.040  -3.652  1.00  1.00
ATOM     34  C   ALA B   8      -4.575  -0.323  -6.128  1.00  1.00
ATOM     35  O   ALA B   8      -5.237  -0.372  -7.163  1.00  1.00
ATOM     36  N   ALA B   9      -3.405   0.289  -6.014  1.00  1.00
ATOM     37  CA  ALA B   9      -2.802   0.969  -7.148  1.00  1.00
ATOM     38  CB  ALA B   9      -1.471   1.591  -6.721  1.00  1.00
ATOM     39  C   ALA B   9      -2.638  -0.022  -8.302  1.00  1.00
ATOM     40  O   ALA B   9      -3.328   0.082  -9.316  1.00  1.00
ATOM     41  N   ALA B  10      -1.722  -0.960  -8.111  1.00  1.00
ATOM     42  CA  ALA B  10      -1.460  -1.967  -9.123  1.00  1.00
ATOM     43  CB  ALA B  10      -0.350  -2.902  -8.638  1.00  1.00
ATOM     44  C   ALA B  10      -2.756  -2.716  -9.440  1.00  1.00
ATOM     45  O   ALA B  10      -3.313  -2.568 -10.526  1.00  1.00
ATOM     46  N   ALA B  11      -3.197  -3.505  -8.471  1.00  1.00
ATOM     47  CA  ALA B  11      -4.418  -4.277  -8.632  1.00  1.00
ATOM     48  CB  ALA B  11      -4.672  -5.101  -7.369  1.00  1.00
ATOM     49  C   ALA B  11      -5.576  -3.331  -8.954  1.00  1.00
ATOM     50  O   ALA B  11      -6.088  -3.329 -10.073  1.00  1.00
ATOM     51  N   ALA B  12      -5.955  -2.550  -7.954  1.00  1.00
ATOM     52  CA  ALA B  12      -7.044  -1.601  -8.116  1.00  1.00
ATOM     53  CB  ALA B  12      -7.269  -0.852  -6.802  1.00  1.00
ATOM     54  C   ALA B  12      -6.723  -0.658  -9.278  1.00  1.00
ATOM     55  O   ALA B  12      -7.361  -0.721 -10.328  1.00  1.00
ATOM     56  N   ALA B  13      -5.736   0.196  -9.050  1.00  1.00
ATOM     57  CA  ALA B  13      -5.323   1.151 -10.064  1.00  1.00
ATOM     58  CB  ALA B  13      -4.180   2.011  -9.521  1.00  1.00
ATOM     59  C   ALA B  13      -4.932   0.399 -11.338  1.00  1.00
ATOM     60  O   ALA B  13      -5.633   0.472 -12.346  1.00  1.00
ATOM     61  N   ALA B  14      -3.815  -0.308 -11.250  1.00  1.00
ATOM     62  CA  ALA B  14      -3.322  -1.073 -12.383  1.00  1.00
ATOM     63  CB  ALA B  14      -2.016  -1.770 -11.999  1.00  1.00
ATOM     64  C   ALA B  14      -4.400  -2.060 -12.833  1.00  1.00
ATOM     65  O   ALA B  14      -4.985  -1.902 -13.904  1.00  1.00
ATOM     66  N   ALA B  15      -4.631  -3.059 -11.993  1.00  1.00
ATOM     67  CA  ALA B  15      -5.629  -4.072 -12.291  1.00  1.00
ATOM     68  CB  ALA B  15      -5.667  -5.100 -11.158  1.00  1.00
ATOM     69  C   ALA B  15      -6.984  -3.398 -12.513  1.00  1.00
ATOM     70  O   ALA B  15      -7.489  -3.365 -13.634  1.00  1.00
ATOM     71  N   ALA B  16      -7.535  -2.877 -11.427  1.00  1.00
ATOM     72  CA  ALA B  16      -8.822  -2.205 -11.488  1.00  1.00
ATOM     73  CB  ALA B  16      -9.214  -1.722 -10.090  1.00  1.00
ATOM     74  C   ALA B  16      -8.748  -1.061 -12.501  1.00  1.00
ATOM     75  O   ALA B  16      -9.357  -1.131 -13.567  1.00  1.00
ATOM     76  N   ALA B  17      -7.995  -0.035 -12.133  1.00  1.00
ATOM     77  CA  ALA B  17      -7.833   1.122 -12.996  1.00  1.00
ATOM     78  CB  ALA B  17      -6.929   2.148 -12.310  1.00  1.00
ATOM     79  C   ALA B  17      -7.280   0.670 -14.349  1.00  1.00
ATOM     80  O   ALA B  17      -7.984   0.712 -15.357  1.00  1.00
ATOM     81  N   ALA B  18      -6.024   0.249 -14.328  1.00  1.00
ATOM     82  CA  ALA B  18      -5.368  -0.211 -15.540  1.00  1.00
ATOM     83  CB  ALA B  18      -3.929  -0.619 -15.219  1.00  1.00
ATOM     84  C   ALA B  18      -6.177  -1.357 -16.150  1.00  1.00
ATOM     85  O   ALA B  18      -6.790  -1.197 -17.205  1.00  1.00
ATOM     86  N   ALA B  19      -6.154  -2.488 -15.460  1.00  1.00
ATOM     87  CA  ALA B  19      -6.878  -3.661 -15.920  1.00  1.00
ATOM     88  CB  ALA B  19      -6.659  -4.814 -14.939  1.00  1.00
ATOM     89  C   ALA B  19      -8.358  -3.309 -16.085  1.00  1.00
ATOM     90  O   ALA B  19      -8.863  -3.243 -17.205  1.00  1.00
ATOM     91  N   ALA B  20      -9.011  -3.092 -14.953  1.00  1.00
ATOM     92  CA  ALA B  20     -10.423  -2.748 -14.958  1.00  1.00
ATOM     93  CB  ALA B  20     -10.911  -2.571 -13.519  1.00  1.00
ATOM     94  C   ALA B  20     -10.635  -1.491 -15.804  1.00  1.00
ATOM     95  O   ALA B  20     -11.217  -1.557 -16.886  1.00  1.00
ATOM     96  N   ALA B  21     -10.151  -0.375 -15.279  1.00  1.00
ATOM     97  CA  ALA B  21     -10.280   0.896 -15.972  1.00  1.00
ATOM     98  CB  ALA B  21      -9.647   2.004 -15.129  1.00  1.00
ATOM     99  C   ALA B  21      -9.642   0.782 -17.358  1.00  1.00
ATOM    100  O   ALA B  21     -10.342   0.792 -18.370  1.00  1.00
ATOM    101  N   ALA B  22      -8.322   0.677 -17.361  1.00  1.00
ATOM    102  CA  ALA B  22      -7.582   0.562 -18.606  1.00  1.00
ATOM    103  CB  ALA B  22      -6.085   0.472 -18.304  1.00  1.00
ATOM    104  C   ALA B  22      -8.093  -0.650 -19.387  1.00  1.00
ATOM    105  O   ALA B  22      -8.733  -0.498 -20.427  1.00  1.00
ATOM      1  N   ALA C   2       1.356  -2.300  -1.164  1.00  1.00           N
ATOM      2  CA  ALA C   2       1.202  -3.661  -1.646  1.00  1.00           C
ATOM      3  CB  ALA C   2       0.838  -4.579  -0.478  1.00  1.00           C
ATOM      4  C   ALA C   2       0.152  -3.689  -2.758  1.00  1.00           C
ATOM      5  O   ALA C   2      -0.088  -4.731  -3.365  1.00  1.00           O
ATOM      6  N   ALA C   3      -0.447  -2.530  -2.991  1.00  1.00           N
ATOM      7  CA  ALA C   3      -1.466  -2.408  -4.020  1.00  1.00           C
ATOM      8  CB  ALA C   3      -2.275  -1.130  -3.787  1.00  1.00           C
ATOM      9  C   ALA C   3      -0.801  -2.434  -5.397  1.00  1.00           C
ATOM     10  O   ALA C   3      -1.483  -2.418  -6.420  1.00  1.00           O
ATOM     11  N   ALA C   4       0.523  -2.474  -5.379  1.00  1.00           N
ATOM     12  CA  ALA C   4       1.288  -2.503  -6.614  1.00  1.00           C
ATOM     13  CB  ALA C   4       2.739  -2.112  -6.325  1.00  1.00           C
ATOM     14  C   ALA C   4       1.174  -3.891  -7.247  1.00  1.00           C
ATOM     15  O   ALA C   4       1.685  -4.122  -8.342  1.00  1.00           O
ATOM     16  N   ALA C   5       0.500  -4.780  -6.531  1.00  1.00           N
ATOM     17  CA  ALA C   5       0.312  -6.139  -7.010  1.00  1.00           C
ATOM     18  CB  ALA C   5      -0.096  -7.039  -5.842  1.00  1.00           C
ATOM     19  C   ALA C   5      -0.723  -6.139  -8.136  1.00  1.00           C
ATOM     20  O   ALA C   5      -0.986  -7.177  -8.742  1.00  1.00           O
ATOM     21  N   ALA C   6      -1.283  -4.964  -8.383  1.00  1.00           N
ATOM     22  CA  ALA C   6      -2.284  -4.816  -9.426  1.00  1.00           C
ATOM     23  CB  ALA C   6      -3.057  -3.513  -9.211  1.00  1.00           C
ATOM     24  C   ALA C   6      -1.601  -4.870 -10.794  1.00  1.00           C
ATOM     25  O   ALA C   6      -2.268  -4.838 -11.827  1.00  1.00           O
ATOM     26  N   ALA C   7      -0.279  -4.950 -10.757  1.00  1.00           N
ATOM     27  CA  ALA C   7       0.502  -5.008 -11.981  1.00  1.00           C
ATOM     28  CB  ALA C   7       1.960  -4.659 -11.673  1.00  1.00           C
ATOM     29  C   ALA C   7       0.354  -6.395 -12.610  1.00  1.00           C
ATOM     30  O   ALA C   7       0.873  -6.646 -13.696  1.00  1.00           O
ATOM     31  N   ALA C   8      -0.356  -7.259 -11.899  1.00  1.00           N
ATOM     32  CA  ALA C   8      -0.579  -8.614 -12.375  1.00  1.00           C
ATOM     33  CB  ALA C   8      -1.030  -9.496 -11.209  1.00  1.00           C
ATOM     34  C   ALA C   8      -1.598  -8.589 -13.515  1.00  1.00           C
ATOM     35  O   ALA C   8      -1.884  -9.621 -14.120  1.00  1.00           O
ATOM     36  N   ALA C   9      -2.118  -7.398 -13.775  1.00  1.00           N
ATOM     37  CA  ALA C   9      -3.100  -7.225 -14.833  1.00  1.00           C
ATOM     38  CB  ALA C   9      -3.836  -5.898 -14.634  1.00  1.00           C
ATOM     39  C   ALA C   9      -2.399  -7.306 -16.191  1.00  1.00           C
ATOM     40  O   ALA C   9      -3.051  -7.259 -17.233  1.00  1.00           O
ATOM     41  N   ALA C  10      -1.081  -7.426 -16.135  1.00  1.00           N
ATOM     42  CA  ALA C  10      -0.285  -7.514 -17.347  1.00  1.00           C
ATOM     43  CB  ALA C  10       1.178  -7.208 -17.021  1.00  1.00           C
ATOM     44  C   ALA C  10      -0.467  -8.899 -17.972  1.00  1.00           C
ATOM     45  O   ALA C  10       0.060  -9.171 -19.050  1.00  1.00           O
ATOM     46  N   ALA C  11      -1.213  -9.737 -17.268  1.00  1.00           N
ATOM     47  CA  ALA C  11      -1.470 -11.087 -17.740  1.00  1.00           C
ATOM     48  CB  ALA C  11      -1.964 -11.949 -16.576  1.00  1.00           C
ATOM     49  C   ALA C  11      -2.472 -11.037 -18.895  1.00  1.00           C
ATOM     50  O   ALA C  11      -2.781 -12.063 -19.499  1.00  1.00           O
ATOM     51  N   ALA C  12      -2.952  -9.832 -19.167  1.00  1.00           N
ATOM     52  CA  ALA C  12      -3.913  -9.634 -20.239  1.00  1.00           C
ATOM     53  CB  ALA C  12      -4.611  -8.285 -20.057  1.00  1.00           C
ATOM     54  C   ALA C  12      -3.197  -9.743 -21.587  1.00  1.00           C
ATOM     55  O   ALA C  12      -3.832  -9.682 -22.638  1.00  1.00           O
ATOM     56  N   ALA C  13      -1.884  -9.903 -21.512  1.00  1.00           N
ATOM     57  CA  ALA C  13      -1.074 -10.021 -22.713  1.00  1.00           C
ATOM     58  CB  ALA C  13       0.393  -9.758 -22.368  1.00  1.00           C
ATOM     59  C   ALA C  13      -1.289 -11.403 -23.334  1.00  1.00           C
ATOM     60  O   ALA C  13      -0.757 -11.696 -24.403  1.00  1.00           O
ATOM     61  N   ALA C  14      -2.070 -12.215 -22.636  1.00  1.00           N
ATOM     62  CA  ALA C  14      -2.362 -13.558 -23.106  1.00  1.00           C
ATOM     63  CB  ALA C  14      -2.898 -14.400 -21.946  1.00  1.00           C
ATOM     64  C   ALA C  14      -3.346 -13.483 -24.275  1.00  1.00           C
ATOM     65  O   ALA C  14      -3.677 -14.502 -24.878  1.00  1.00           O
ATOM     66  N   ALA C  15      -3.785 -12.266 -24.560  1.00  1.00           N
ATOM     67  CA  ALA C  15      -4.725 -12.045 -25.646  1.00  1.00           C
ATOM     68  CB  ALA C  15      -5.384 -10.674 -25.479  1.00  1.00           C
ATOM     69  C   ALA C  15      -3.994 -12.182 -26.983  1.00  1.00           C
ATOM     70  O   ALA C  15      -4.612 -12.106 -28.043  1.00  1.00           O
ATOM     71  N   ALA C  16      -2.687 -12.381 -26.889  1.00  1.00           N
ATOM     72  CA  ALA C  16      -1.865 -12.529 -28.077  1.00  1.00           C
ATOM     73  CB  ALA C  16      -0.396 -12.309 -27.713  1.00  1.00           C
ATOM     74  C   ALA C  16      -2.113 -13.907 -28.695  1.00  1.00           C
ATOM     75  O   ALA C  16      -1.575 -14.222 -29.756  1.00  1.00           O
ATOM     76  N   ALA C  17      -2.928 -14.691 -28.005  1.00  1.00           N
ATOM     77  CA  ALA C  17      -3.254 -16.028 -28.473  1.00  1.00           C
ATOM     78  CB  ALA C  17      -3.831 -16.847 -27.316  1.00  1.00           C
ATOM     79  C   ALA C  17      -4.219 -15.929 -29.656  1.00  1.00           C
ATOM     80  O   ALA C  17      -4.573 -16.940 -30.259  1.00  1.00           O
ATOM     81  N   ALA C  18      -4.617 -14.700 -29.952  1.00  1.00           N
ATOM     82  CA  ALA C  18      -5.534 -14.456 -31.052  1.00  1.00           C
ATOM     83  CB  ALA C  18      -6.154 -13.065 -30.901  1.00  1.00           C
ATOM     84  C   ALA C  18      -4.789 -14.621 -32.378  1.00  1.00           C
ATOM     85  O   ALA C  18      -5.391 -14.532 -33.447  1.00  1.00           O
ATOM     86  N   ALA C  19      -3.491 -14.860 -32.265  1.00  1.00           N
ATOM     87  CA  ALA C  19      -2.657 -15.038 -33.442  1.00  1.00           C
ATOM     88  CB  ALA C  19      -1.187 -14.862 -33.057  1.00  1.00           C
ATOM     89  C   ALA C  19      -2.938 -16.411 -34.056  1.00  1.00           C
ATOM     90  O   ALA C  19      -2.396 -16.747 -35.108  1.00  1.00           O
ATOM     91  N   ALA C  20      -3.786 -17.167 -33.375  1.00  1.00           N
ATOM     92  CA  ALA C  20      -4.146 -18.495 -33.840  1.00  1.00           C
ATOM     93  CB  ALA C  20      -4.764 -19.291 -32.689  1.00  1.00           C
ATOM     94  C   ALA C  20      -5.091 -18.373 -35.037  1.00  1.00           C
ATOM     95  O   ALA C  20      -5.468 -19.376 -35.641  1.00  1.00           O
ATOM     96  N   ALA C  21      -5.448 -17.134 -35.345  1.00  1.00           N
ATOM     97  CA  ALA C  21      -6.342 -16.867 -36.458  1.00  1.00           C
ATOM     98  CB  ALA C  21      -6.921 -15.458 -36.322  1.00  1.00           C
ATOM     99  C   ALA C  21      -5.584 -17.062 -37.773  1.00  1.00           C
ATOM    100  O   ALA C  21      -6.168 -16.960 -38.851  1.00  1.00           O
ATOM    101  N   ALA C  22      -4.295 -17.339 -37.641  1.00  1.00           N
ATOM    102  CA  ALA C  22      -3.451 -17.549 -38.805  1.00  1.00           C
ATOM    103  CB  ALA C  22      -1.982 -17.415 -38.401  1.00  1.00           C
ATOM    104  C   ALA C  22      -3.766 -18.915 -39.417  1.00  1.00           C
ATOM    105  O   ALA C  22      -3.219 -19.273 -40.460  1.00  1.00           O
"""
  print "Finding alpha,3-10 and pi helices...",
  import iotbx.pdb
  from cctbx.array_family import flex
  hierarchy=iotbx.pdb.input(source_info='text',
       lines=flex.split_lines(text)).construct_hierarchy()
  fss=find_secondary_structure(hierarchy=hierarchy,out=null_out())

  expected_text="""
Model 1  N: 16  Start: 1 End: 16
Class:  Alpha helix  N: 16 Start: 1 End: 16  Rise: 1.51 A Dot: 0.98

Model 2  N: 21  Start: 2 End: 22
Class:     Pi helix  N: 21 Start: 2 End: 22  Rise: 0.96 A Dot: 0.98

Model 3  N: 21  Start: 2 End: 22
Class:   3-10 helix  N: 20 Start: 2 End: 21  Rise: 1.99 A Dot: 1.00

PDB RECORDS:
HELIX    1   1 ALA A    1  ALA A   16  1                                  16
HELIX    1   1 ALA C    2  ALA C   21  5                                  20
HELIX    1   1 ALA B    2  ALA B   22  3                                  21



PDB Selections:
" ( chain 'A' and resseq 1:16 and icode ' ')  or  ( chain 'C' and resseq 2:21 and icode ' ')  or  ( chain 'B' and resseq 2:22 and icode ' ') "
"""
  f=StringIO()
  fss.show_summary(out=f,verbose=True)
  found_text=f.getvalue()
  if remove_blank(found_text)!=remove_blank(expected_text):
    print "Expected: \n%s \nFound: \n%s" %(expected_text,found_text)
    raise AssertionError, "FAILED"
  print "OK"

if __name__=="__main__":
  tst_01()
  tst_02()
  tst_03()
