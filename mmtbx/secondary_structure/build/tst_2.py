from __future__ import division
from mmtbx.secondary_structure import build as ssb
import iotbx.pdb
from iotbx.pdb import secondary_structure as ioss
from scitbx.array_family import flex

tst_00_start_lines = """\
ATOM      1  N   SER A   2      35.297  13.646  38.741  1.00 25.20           N
ATOM      2  CA  SER A   2      36.338  14.513  38.201  1.00 23.89           C
ATOM      3  C   SER A   2      35.963  15.024  36.813  1.00 22.90           C
ATOM      4  O   SER A   2      36.377  16.112  36.414  1.00 23.08           O
ATOM      5  CB  SER A   2      37.676  13.773  38.145  1.00 23.11           C
ATOM      6  N   PRO A   3      35.174  14.230  36.074  1.00 22.39           N
ATOM      7  CA  PRO A   3      34.697  14.560  34.727  1.00 19.74           C
ATOM      8  C   PRO A   3      33.762  15.765  34.734  1.00 13.82           C
ATOM      9  O   PRO A   3      33.782  16.567  33.801  1.00 12.80           O
ATOM     10  CB  PRO A   3      33.930  13.302  34.316  1.00 23.07           C
ATOM     11  N   LEU A   4      32.952  15.881  35.782  1.00 11.29           N
ATOM     12  CA  LEU A   4      32.002  16.982  35.905  1.00  9.66           C
ATOM     13  C   LEU A   4      32.704  18.325  36.079  1.00  7.86           C
ATOM     14  O   LEU A   4      32.252  19.341  35.551  1.00  7.65           O
ATOM     15  CB  LEU A   4      31.045  16.734  37.073  1.00 10.57           C
ATOM     16  N   ALA A   5      33.804  18.327  36.825  1.00  8.13           N
ATOM     17  CA  ALA A   5      34.574  19.547  37.045  1.00  8.04           C
ATOM     18  C   ALA A   5      35.262  20.002  35.761  1.00  7.24           C
ATOM     19  O   ALA A   5      35.319  21.196  35.464  1.00  6.98           O
ATOM     20  CB  ALA A   5      35.597  19.336  38.151  1.00  9.33           C
ATOM     21  N   GLN A   6      35.778  19.040  35.003  1.00  6.89           N
ATOM     22  CA  GLN A   6      36.437  19.332  33.736  1.00  7.52           C
ATOM     23  C   GLN A   6      35.426  19.821  32.707  1.00  5.67           C
ATOM     24  O   GLN A   6      35.714  20.721  31.917  1.00  5.64           O
ATOM     25  CB  GLN A   6      37.166  18.093  33.212  1.00  9.58           C
ATOM     26  N   GLN A   7      34.239  19.223  32.724  1.00  5.24           N
ATOM     27  CA  GLN A   7      33.169  19.614  31.817  1.00  4.92           C
ATOM     28  C   GLN A   7      32.652  21.006  32.158  1.00  4.44           C
ATOM     29  O   GLN A   7      32.319  21.788  31.270  1.00  4.63           O
ATOM     30  CB  GLN A   7      32.024  18.600  31.868  1.00  5.87           C
ATOM     31  N   ILE A   8      32.582  21.306  33.451  1.00  4.24           N
ATOM     32  CA  ILE A   8      32.135  22.614  33.914  1.00  4.30           C
ATOM     33  C   ILE A   8      33.159  23.694  33.584  1.00  4.16           C
ATOM     34  O   ILE A   8      32.799  24.810  33.207  1.00  5.21           O
ATOM     35  CB  ILE A   8      31.871  22.618  35.431  1.00  4.60           C
ATOM     36  N   LYS A   9      34.437  23.355  33.727  1.00  4.57           N
ATOM     37  CA  LYS A   9      35.513  24.288  33.414  1.00  5.70           C
ATOM     38  C   LYS A   9      35.572  24.547  31.913  1.00  5.50           C
ATOM     39  O   LYS A   9      35.800  25.676  31.473  1.00  6.01           O
ATOM     40  CB  LYS A   9      36.855  23.746  33.909  1.00  8.15           C
ATOM     41  N   ASN A  10      35.358  23.493  31.131  1.00  5.00           N
ATOM     42  CA  ASN A  10      35.346  23.607  29.679  1.00  5.09           C
ATOM     43  C   ASN A  10      34.143  24.408  29.198  1.00  4.73           C
ATOM     44  O   ASN A  10      34.240  25.175  28.242  1.00  4.79           O
ATOM     45  CB  ASN A  10      35.350  22.222  29.030  1.00  5.93           C
ATOM     46  N   ILE A  11      33.010  24.220  29.866  1.00  4.14           N
ATOM     47  CA  ILE A  11      31.789  24.946  29.534  1.00  4.17           C
ATOM     48  C   ILE A  11      31.911  26.423  29.892  1.00  4.30           C
ATOM     49  O   ILE A  11      31.423  27.287  29.165  1.00  4.57           O
ATOM     50  CB  ILE A  11      30.563  24.354  30.253  1.00  4.26           C
ATOM     51  N   GLU A  12      32.554  26.705  31.021  1.00  5.14           N
ATOM     52  CA  GLU A  12      32.765  28.081  31.458  1.00  6.72           C
ATOM     53  C   GLU A  12      33.762  28.794  30.550  1.00  5.62           C
ATOM     54  O   GLU A  12      33.583  29.966  30.211  1.00  6.01           O
ATOM     55  CB  GLU A  12      33.253  28.115  32.908  1.00  8.41           C
ATOM     56  N   SER A  13      34.809  28.076  30.155  1.00  5.36           N
ATOM     57  CA  SER A  13      35.819  28.627  29.260  0.48  5.54           C
ATOM     58  C   SER A  13      35.220  28.870  27.881  1.00  4.98           C
ATOM     59  O   SER A  13      35.535  29.859  27.221  1.00  5.24           O
ATOM     60  CB  SER A  13      37.018  27.683  29.155  0.48  7.24           C
ATOM     61  N   PHE A  14      34.350  27.958  27.457  1.00  4.22           N
ATOM     62  CA  PHE A  14      33.665  28.082  26.177  1.00  4.26           C
ATOM     63  C   PHE A  14      32.679  29.242  26.205  1.00  3.83           C
ATOM     64  O   PHE A  14      32.483  29.920  25.201  1.00  4.21           O
ATOM     65  CB  PHE A  14      32.938  26.783  25.823  1.00  4.34           C
ATOM     66  N   ILE A  15      32.050  29.454  27.356  1.00  3.71           N
ATOM     67  CA  ILE A  15      31.101  30.549  27.522  1.00  3.57           C
ATOM     68  C   ILE A  15      31.803  31.904  27.525  1.00  3.45           C
ATOM     69  O   ILE A  15      31.312  32.867  26.935  1.00  3.86           O
ATOM     70  CB  ILE A  15      30.289  30.401  28.823  1.00  4.42           C
ATOM     71  N   HIS A  16      32.953  31.972  28.191  0.73  3.71           N
ATOM     72  CA  HIS A  16      33.733  33.204  28.237  0.73  3.79           C
ATOM     73  C   HIS A  16      34.322  33.510  26.864  0.73  3.39           C
ATOM     74  O   HIS A  16      34.358  34.666  26.428  0.73  3.85           O
ATOM     75  CB  HIS A  16      34.850  33.095  29.276  0.73  4.49           C
ATOM     76  N   GLN A  17      34.771  32.460  26.182  0.73  3.40           N
ATOM     77  CA  GLN A  17      35.326  32.593  24.843  0.73  3.79           C
ATOM     78  C   GLN A  17      34.237  33.024  23.872  0.73  3.29           C
ATOM     79  O   GLN A  17      34.486  33.794  22.952  0.73  3.69           O
ATOM     80  CB  GLN A  17      35.951  31.276  24.382  0.73  4.26           C
ATOM     81  N   ALA A  18      33.029  32.517  24.081  1.00  3.36           N
ATOM     82  CA  ALA A  18      31.889  32.893  23.257  1.00  3.89           C
ATOM     83  C   ALA A  18      31.514  34.345  23.518  1.00  4.05           C
ATOM     84  O   ALA A  18      31.092  35.060  22.610  1.00  4.91           O
ATOM     85  CB  ALA A  18      30.705  31.980  23.533  1.00  4.53           C
ATOM     86  N   LYS A  19      31.661  34.773  24.768  1.00  4.37           N
ATOM     87  CA  LYS A  19      31.330  36.142  25.141  1.00  5.39           C
ATOM     88  C   LYS A  19      32.309  37.167  24.571  1.00  5.25           C
ATOM     89  O   LYS A  19      31.891  38.187  24.022  1.00  5.52           O
ATOM     90  CB  LYS A  19      31.261  36.276  26.664  1.00  6.50           C
ATOM     91  N   ALA A  20      33.608  36.904  24.697  1.00  5.38           N
ATOM     92  CA  ALA A  20      34.602  37.833  24.160  1.00  5.88           C
ATOM     93  C   ALA A  20      34.717  37.749  22.638  1.00  5.38           C
ATOM     94  O   ALA A  20      34.663  38.763  21.943  1.00  6.73           O
ATOM     95  CB  ALA A  20      35.958  37.592  24.810  1.00  6.65           C
ATOM     96  N   ALA A  21      34.877  36.530  22.132  1.00  4.87           N
ATOM     97  CA  ALA A  21      34.919  36.267  20.695  1.00  5.54           C
ATOM     98  C   ALA A  21      33.517  36.185  20.104  1.00  4.89           C
ATOM     99  O   ALA A  21      32.541  36.580  20.741  1.00  5.59           O
ATOM    100  CB  ALA A  21      35.709  35.002  20.393  1.00  6.30           C
ATOM    101  N   GLY A  22      33.429  35.682  18.876  1.00  4.70           N
ATOM    102  CA  GLY A  22      32.150  35.469  18.222  1.00  4.84           C
ATOM    103  C   GLY A  22      31.234  34.541  19.001  1.00  4.56           C
ATOM    104  O   GLY A  22      31.687  33.750  19.830  1.00  5.92           O
ATOM    105  N   ARG A  23      29.938  34.639  18.724  1.00  4.30           N
ATOM    106  CA  ARG A  23      28.917  33.916  19.478  1.00  4.97           C
ATOM    107  C   ARG A  23      28.339  32.726  18.714  1.00  5.19           C
ATOM    108  O   ARG A  23      28.359  31.591  19.196  1.00  5.70           O
ATOM    109  CB  ARG A  23      27.792  34.865  19.896  1.00  5.52           C
ATOM    110  N   MET A  24      27.823  33.003  17.520  0.69  5.87           N
ATOM    111  CA  MET A  24      27.131  32.007  16.707  0.69  7.12           C
ATOM    112  C   MET A  24      27.979  30.787  16.355  0.69  6.14           C
ATOM    113  O   MET A  24      27.452  29.685  16.228  0.69  5.80           O
ATOM    114  CB  MET A  24      26.593  32.649  15.425  0.69  9.83           C
ATOM    115  N   ASP A  25      29.282  30.981  16.182  1.00  6.26           N
ATOM    116  CA  ASP A  25      30.170  29.863  15.877  1.00  6.70           C
ATOM    117  C   ASP A  25      30.293  28.915  17.070  1.00  5.34           C
ATOM    118  O   ASP A  25      30.261  27.691  16.913  1.00  5.81           O
ATOM    119  CB  ASP A  25      31.553  30.374  15.467  1.00  9.38           C
ATOM    120  N   GLU A  26      30.415  29.491  18.262  0.67  4.76           N
ATOM    121  CA  GLU A  26      30.516  28.708  19.488  0.67  4.83           C
ATOM    122  C   GLU A  26      29.195  28.010  19.790  0.67  4.62           C
ATOM    123  O   GLU A  26      29.175  26.864  20.246  0.67  4.93           O
ATOM    124  CB  GLU A  26      30.920  29.601  20.663  0.67  5.41           C
ATOM    125  N   VAL A  27      28.094  28.707  19.527  1.00  4.54           N
ATOM    126  CA  VAL A  27      26.766  28.144  19.737  1.00  5.02           C
ATOM    127  C   VAL A  27      26.514  27.000  18.761  1.00  4.94           C
ATOM    128  O   VAL A  27      25.883  26.003  19.109  1.00  5.05           O
ATOM    129  CB  VAL A  27      25.667  29.209  19.566  1.00  5.29           C
ATOM    130  N   ARG A  28      27.012  27.155  17.539  1.00  5.20           N
ATOM    131  CA  ARG A  28      26.880  26.126  16.515  1.00  5.54           C
ATOM    132  C   ARG A  28      27.724  24.906  16.863  1.00  4.76           C
ATOM    133  O   ARG A  28      27.311  23.770  16.630  1.00  5.46           O
ATOM    134  CB  ARG A  28      27.288  26.671  15.145  1.00  6.82           C
ATOM    135  N   THR A  29      28.908  25.147  17.418  1.00  4.62           N
ATOM    136  CA  THR A  29      29.787  24.058  17.829  1.00  5.38           C
ATOM    137  C   THR A  29      29.183  23.294  19.005  1.00  4.39           C
ATOM    138  O   THR A  29      29.254  22.064  19.065  1.00  5.02           O
ATOM    139  CB  THR A  29      31.182  24.575  18.224  1.00  7.77           C
ATOM    140  N   LEU A  30      28.579  24.032  19.931  1.00  4.10           N
ATOM    141  CA  LEU A  30      27.937  23.429  21.093  1.00  4.03           C
ATOM    142  C   LEU A  30      26.699  22.638  20.684  1.00  4.40           C
ATOM    143  O   LEU A  30      26.424  21.569  21.231  1.00  4.33           O
ATOM    144  CB  LEU A  30      27.563  24.502  22.117  1.00  4.41           C
ATOM    145  N   GLN A  31      25.956  23.171  19.719  1.00  4.65           N
ATOM    146  CA  GLN A  31      24.760  22.507  19.214  1.00  5.33           C
ATOM    147  C   GLN A  31      25.128  21.239  18.451  1.00  5.02           C
ATOM    148  O   GLN A  31      24.432  20.227  18.538  1.00  5.56           O
ATOM    149  CB  GLN A  31      23.961  23.450  18.314  1.00  6.58           C
ATOM    150  N   GLU A  32      26.224  21.304  17.702  1.00  5.72           N
ATOM    151  CA  GLU A  32      26.705  20.153  16.949  1.00  6.90           C
ATOM    152  C   GLU A  32      27.211  19.070  17.894  1.00  5.82           C
ATOM    153  O   GLU A  32      26.996  17.879  17.663  1.00  6.63           O
ATOM    154  CB  GLU A  32      27.816  20.568  15.982  1.00 10.01           C
ATOM    155  N   ASN A  33      27.881  19.491  18.963  1.00  5.36           N
ATOM    156  CA  ASN A  33      28.380  18.557  19.964  1.00  5.56           C
ATOM    157  C   ASN A  33      27.239  17.898  20.732  1.00  5.07           C
ATOM    158  O   ASN A  33      27.291  16.706  21.041  1.00  6.19           O
ATOM    159  CB  ASN A  33      29.329  19.264  20.933  1.00  6.47           C
ATOM    160  N   LEU A  34      26.207  18.681  21.030  1.00  4.51           N
ATOM    161  CA  LEU A  34      25.036  18.173  21.734  1.00  4.72           C
ATOM    162  C   LEU A  34      24.248  17.208  20.854  1.00  4.80           C
ATOM    163  O   LEU A  34      23.731  16.198  21.332  1.00  4.90           O
ATOM    164  CB  LEU A  34      24.138  19.327  22.184  1.00  4.81           C
ATOM    165  N   HIS A  35      24.161  17.528  19.567  1.00  5.03           N
ATOM    166  CA  HIS A  35      23.463  16.676  18.611  1.00  5.85           C
ATOM    167  C   HIS A  35      24.218  15.369  18.399  1.00  5.91           C
ATOM    168  O   HIS A  35      23.612  14.304  18.272  1.00  6.51           O
ATOM    169  CB  HIS A  35      23.283  17.402  17.276  1.00  7.35           C
ATOM    170  N   GLN A  36      25.544  15.458  18.365  1.00  5.86           N
ATOM    171  CA  GLN A  36      26.385  14.279  18.203  1.00  7.12           C
ATOM    172  C   GLN A  36      26.310  13.391  19.440  1.00  5.57           C
ATOM    173  O   GLN A  36      26.294  12.164  19.336  1.00  6.15           O
ATOM    174  CB  GLN A  36      27.835  14.686  17.934  1.00 10.81           C
ATOM    175  N   LEU A  37      26.261  14.020  20.611  1.00  4.79           N
ATOM    176  CA  LEU A  37      26.156  13.290  21.868  1.00  5.02           C
ATOM    177  C   LEU A  37      24.795  12.613  21.990  1.00  4.81           C
ATOM    178  O   LEU A  37      24.692  11.490  22.485  1.00  5.11           O
ATOM    179  CB  LEU A  37      26.386  14.228  23.055  1.00  5.48           C
ATOM    180  N   MET A  38      23.754  13.303  21.535  1.00  5.10           N
ATOM    181  CA  MET A  38      22.401  12.760  21.565  0.60  5.87           C
ATOM    182  C   MET A  38      22.262  11.601  20.584  1.00  5.55           C
ATOM    183  O   MET A  38      21.594  10.607  20.873  1.00  5.83           O
ATOM    184  CB  MET A  38      21.378  13.850  21.241  0.60  7.11           C
ATOM    185  N   HIS A  39      22.897  11.736  19.424  1.00  5.90           N
ATOM    186  CA  HIS A  39      22.871  10.689  18.410  1.00  6.60           C
ATOM    187  C   HIS A  39      23.647   9.464  18.879  1.00  6.76           C
ATOM    188  O   HIS A  39      23.242   8.328  18.631  1.00  7.35           O
ATOM    189  CB  HIS A  39      23.447  11.204  17.090  1.00  7.90           C
ATOM    190  N   GLU A  40      24.765   9.703  19.558  1.00  6.24           N
ATOM    191  CA  GLU A  40      25.583   8.621  20.092  1.00  7.45           C
ATOM    192  C   GLU A  40      24.859   7.903  21.225  1.00  6.69           C
ATOM    193  O   GLU A  40      24.937   6.680  21.348  1.00  7.99           O
ATOM    194  CB  GLU A  40      26.929   9.158  20.583  1.00  8.91           C
ATOM    195  N   TYR A  41      24.153   8.672  22.048  1.00  6.31           N
ATOM    196  CA  TYR A  41      23.389   8.109  23.156  1.00  6.52           C
ATOM    197  C   TYR A  41      22.206   7.298  22.641  1.00  6.93           C
ATOM    198  O   TYR A  41      21.872   6.249  23.194  1.00  7.89           O
ATOM    199  CB  TYR A  41      22.900   9.219  24.089  1.00  6.84           C
ATOM    200  N   PHE A  42      21.574   7.791  21.581  1.00  7.44           N
ATOM    201  CA  PHE A  42      20.448   7.095  20.968  1.00  9.29           C
ATOM    202  C   PHE A  42      20.907   5.812  20.283  1.00 11.50           C
ATOM    203  O   PHE A  42      20.219   4.792  20.331  1.00 13.50           O
ATOM    204  CB  PHE A  42      19.739   8.004  19.962  1.00  9.49           C
ATOM    205  N   GLN A  43      22.072   5.872  19.646  1.00 11.97           N
ATOM    206  CA  GLN A  43      22.637   4.711  18.968  1.00 13.21           C
ATOM    207  C   GLN A  43      23.083   3.647  19.966  1.00 16.37           C
ATOM    208  O   GLN A  43      22.917   2.451  19.727  1.00 17.39           O
ATOM    209  CB  GLN A  43      23.813   5.127  18.082  1.00 11.79           C
ATOM    210  N   GLN A  44      23.652   4.091  21.082  1.00 19.32           N
ATOM    211  CA  GLN A  44      24.109   3.178  22.125  1.00 22.77           C
ATOM    212  C   GLN A  44      22.935   2.498  22.821  1.00 25.16           C
ATOM    213  O   GLN A  44      23.114   1.528  23.557  1.00 27.03           O
ATOM    214  CB  GLN A  44      24.968   3.921  23.150  1.00 23.69           C
TER
"""

tst_01_start_lines = """
ATOM      1  N   SER A   2      34.351  13.914  38.850  1.00 25.20           N
ATOM      2  CA  SER A   2      35.564  14.555  38.349  1.00 23.89           C
ATOM      3  C   SER A   2      35.509  14.878  36.846  1.00 22.90           C
ATOM      4  O   SER A   2      35.800  16.010  36.460  1.00 23.08           O
ATOM      5  CB  SER A   2      36.790  13.687  38.657  1.00 23.11           C
ATOM      6  OG  SER A   2      36.939  13.492  40.053  1.00 21.13           O
ATOM      7  N   PRO A   3      35.146  13.899  35.989  1.00 22.39           N
ATOM      8  CA  PRO A   3      35.107  14.258  34.566  1.00 19.74           C
ATOM      9  C   PRO A   3      34.000  15.256  34.228  1.00 13.82           C
ATOM     10  O   PRO A   3      34.193  16.119  33.371  1.00 12.80           O
ATOM     11  CB  PRO A   3      34.857  12.915  33.872  1.00 23.07           C
ATOM     12  CG  PRO A   3      34.164  12.092  34.890  1.00 24.21           C
ATOM     13  CD  PRO A   3      34.778  12.485  36.199  1.00 23.79           C
ATOM     14  N   LEU A   4      32.857  15.135  34.897  1.00 11.29           N
ATOM     15  CA  LEU A   4      31.727  16.026  34.654  1.00  9.66           C
ATOM     16  C   LEU A   4      32.034  17.454  35.105  1.00  7.86           C
ATOM     17  O   LEU A   4      31.610  18.416  34.465  1.00  7.65           O
ATOM     18  CB  LEU A   4      30.456  15.496  35.345  1.00 10.57           C
ATOM     19  CG  LEU A   4      30.191  15.483  36.863  1.00 11.83           C
ATOM     20  CD1 LEU A   4      29.728  16.845  37.386  1.00 12.67           C
ATOM     21  CD2 LEU A   4      31.376  14.965  37.676  1.00 13.04           C
ATOM     22  N   ALA A   5      32.770  17.587  36.205  1.00  8.13           N
ATOM     23  CA  ALA A   5      33.144  18.900  36.719  1.00  8.04           C
ATOM     24  C   ALA A   5      34.126  19.589  35.777  1.00  7.24           C
ATOM     25  O   ALA A   5      34.030  20.794  35.529  1.00  6.98           O
ATOM     26  CB  ALA A   5      33.740  18.775  38.112  1.00  9.33           C
ATOM     27  N   GLN A   6      35.065  18.813  35.246  1.00  6.89           N
ATOM     28  CA  GLN A   6      36.032  19.335  34.292  1.00  7.52           C
ATOM     29  C   GLN A   6      35.326  19.718  33.000  1.00  5.67           C
ATOM     30  O   GLN A   6      35.664  20.719  32.364  1.00  5.64           O
ATOM     31  CB  GLN A   6      37.135  18.311  34.017  1.00  9.58           C
ATOM     32  CG  GLN A   6      38.024  18.016  35.215  1.00 12.45           C
ATOM     33  CD  GLN A   6      38.792  19.235  35.688  1.00 16.41           C
ATOM     34  OE1 GLN A   6      39.169  20.095  34.891  1.00 17.91           O
ATOM     35  NE2 GLN A   6      39.026  19.317  36.993  1.00 18.48           N
ATOM     36  N   GLN A   7      34.330  18.921  32.627  1.00  5.24           N
ATOM     37  CA  GLN A   7      33.571  19.174  31.411  1.00  4.92           C
ATOM     38  C   GLN A   7      32.744  20.449  31.523  1.00  4.44           C
ATOM     39  O   GLN A   7      32.739  21.270  30.609  1.00  4.63           O
ATOM     40  CB  GLN A   7      32.661  17.985  31.094  1.00  5.87           C
ATOM     41  CG  GLN A   7      31.868  18.136  29.805  1.00  8.74           C
ATOM     42  CD  GLN A   7      31.016  16.920  29.500  1.00 11.90           C
ATOM     43  OE1 GLN A   7      31.059  15.921  30.219  1.00 17.10           O
ATOM     44  NE2 GLN A   7      30.235  16.999  28.429  1.00 12.32           N
ATOM     45  N   ILE A   8      32.069  20.633  32.653  1.00  4.24           N
ATOM     46  CA  ILE A   8      31.246  21.823  32.833  1.00  4.30           C
ATOM     47  C   ILE A   8      32.114  23.072  33.008  1.00  4.16           C
ATOM     48  O   ILE A   8      31.758  24.146  32.517  1.00  5.21           O
ATOM     49  CB  ILE A   8      30.262  21.674  34.028  1.00  4.60           C
ATOM     50  CG1 ILE A   8      29.291  22.857  34.076  1.00  5.10           C
ATOM     51  CG2 ILE A   8      30.995  21.526  35.350  1.00  4.97           C
ATOM     52  CD1 ILE A   8      28.415  22.977  32.848  1.00  5.70           C
ATOM     53  N   LYS A   9      33.252  22.941  33.687  1.00  4.57           N
ATOM     54  CA  LYS A   9      34.120  24.099  33.882  1.00  5.70           C
ATOM     55  C   LYS A   9      34.801  24.516  32.574  1.00  5.50           C
ATOM     56  O   LYS A   9      34.930  25.712  32.300  1.00  6.01           O
ATOM     57  CB  LYS A   9      35.164  23.834  34.978  1.00  8.15           C
ATOM     58  CG  LYS A   9      36.291  22.887  34.608  1.00 13.11           C
ATOM     59  CD  LYS A   9      37.294  22.751  35.743  1.00 17.07           C
ATOM     60  CE  LYS A   9      36.641  22.185  36.994  1.00 20.09           C
ATOM     61  NZ  LYS A   9      37.615  22.041  38.112  1.00 22.35           N
ATOM     62  N   ASN A  10      35.227  23.550  31.761  1.00  5.00           N
ATOM     63  CA  ASN A  10      35.842  23.898  30.484  1.00  5.09           C
ATOM     64  C   ASN A  10      34.792  24.427  29.512  1.00  4.73           C
ATOM     65  O   ASN A  10      35.075  25.320  28.711  1.00  4.79           O
ATOM     66  CB  ASN A  10      36.618  22.712  29.883  1.00  5.93           C
ATOM     67  CG  ASN A  10      35.730  21.547  29.469  1.00  6.66           C
ATOM     68  OD1 ASN A  10      34.715  21.717  28.794  1.00  7.40           O
ATOM     69  ND2 ASN A  10      36.134  20.344  29.858  1.00  8.16           N
ATOM     70  N   ILE A  11      33.579  23.881  29.591  1.00  4.14           N
ATOM     71  CA  ILE A  11      32.485  24.354  28.750  1.00  4.17           C
ATOM     72  C   ILE A  11      32.165  25.800  29.101  1.00  4.30           C
ATOM     73  O   ILE A  11      31.964  26.636  28.216  1.00  4.57           O
ATOM     74  CB  ILE A  11      31.217  23.481  28.900  1.00  4.26           C
ATOM     75  CG1 ILE A  11      31.325  22.234  28.021  1.00  4.74           C
ATOM     76  CG2 ILE A  11      29.969  24.260  28.518  1.00  5.09           C
ATOM     77  CD1 ILE A  11      30.158  21.281  28.165  1.00  5.63           C
ATOM     78  N   GLU A  12      32.173  26.097  30.396  1.00  5.14           N
ATOM     79  CA  GLU A  12      31.933  27.453  30.866  1.00  6.72           C
ATOM     80  C   GLU A  12      33.067  28.362  30.404  1.00  5.62           C
ATOM     81  O   GLU A  12      32.845  29.523  30.048  1.00  6.01           O
ATOM     82  CB  GLU A  12      31.800  27.481  32.392  1.00  8.41           C
ATOM     83  CG  GLU A  12      31.326  28.810  32.968  1.00 10.55           C
ATOM     84  CD  GLU A  12      32.457  29.796  33.193  1.00 11.85           C
ATOM     85  OE1 GLU A  12      33.623  29.358  33.274  1.00 13.15           O
ATOM     86  OE2 GLU A  12      32.178  31.010  33.290  1.00 11.88           O
ATOM     87  N   SER A  13      34.281  27.822  30.391  1.00  5.36           N
ATOM     88  CA  SER A  13      35.443  28.605  29.996  0.48  5.54           C
ATOM     89  C   SER A  13      35.431  28.984  28.515  1.00  4.98           C
ATOM     90  O   SER A  13      35.623  30.158  28.175  1.00  5.24           O
ATOM     91  CB  SER A  13      36.728  27.839  30.320  0.48  7.24           C
ATOM     92  OG  SER A  13      37.874  28.579  29.935  0.48  8.58           O
ATOM     93  N   PHE A  14      35.187  28.019  27.630  1.00  4.22           N
ATOM     94  CA  PHE A  14      35.185  28.362  26.211  1.00  4.26           C
ATOM     95  C   PHE A  14      33.912  29.116  25.824  1.00  3.83           C
ATOM     96  O   PHE A  14      33.946  29.930  24.905  1.00  4.21           O
ATOM     97  CB  PHE A  14      35.434  27.135  25.298  1.00  4.34           C
ATOM     98  CG  PHE A  14      34.346  26.085  25.291  1.00  4.32           C
ATOM     99  CD1 PHE A  14      33.092  26.342  24.758  1.00  5.73           C
ATOM    100  CD2 PHE A  14      34.625  24.799  25.721  1.00  4.92           C
ATOM    101  CE1 PHE A  14      32.119  25.363  24.729  1.00  6.75           C
ATOM    102  CE2 PHE A  14      33.661  23.811  25.681  1.00  5.77           C
ATOM    103  CZ  PHE A  14      32.404  24.096  25.189  1.00  6.41           C
ATOM    104  N   ILE A  15      32.795  28.855  26.500  1.00  3.71           N
ATOM    105  CA  ILE A  15      31.581  29.610  26.195  1.00  3.57           C
ATOM    106  C   ILE A  15      31.766  31.066  26.631  1.00  3.45           C
ATOM    107  O   ILE A  15      31.252  31.976  25.984  1.00  3.86           O
ATOM    108  CB  ILE A  15      30.304  29.004  26.847  1.00  4.42           C
ATOM    109  CG1 ILE A  15      29.046  29.556  26.174  1.00  5.07           C
ATOM    110  CG2 ILE A  15      30.234  29.286  28.335  1.00  5.27           C
ATOM    111  CD1 ILE A  15      28.921  29.196  24.717  1.00  5.89           C
ATOM    112  N   HIS A  16      32.500  31.286  27.721  0.73  3.71           N
ATOM    113  CA  HIS A  16      32.766  32.646  28.182  0.73  3.79           C
ATOM    114  C   HIS A  16      33.758  33.374  27.274  0.73  3.39           C
ATOM    115  O   HIS A  16      33.541  34.536  26.904  0.73  3.85           O
ATOM    116  CB  HIS A  16      33.292  32.632  29.619  0.73  4.49           C
ATOM    117  CG  HIS A  16      33.579  33.994  30.170  0.73  5.87           C
ATOM    118  ND1 HIS A  16      32.610  34.965  30.298  0.73  8.05           N
ATOM    119  CD2 HIS A  16      34.728  34.546  30.627  0.73  5.56           C
ATOM    120  CE1 HIS A  16      33.148  36.057  30.810  0.73  7.55           C
ATOM    121  NE2 HIS A  16      34.432  35.830  31.019  0.73  6.08           N
ATOM    122  N   GLN A  17      34.833  32.685  26.896  0.73  3.40           N
ATOM    123  CA  GLN A  17      35.849  33.300  26.046  0.73  3.79           C
ATOM    124  C   GLN A  17      35.277  33.576  24.658  0.73  3.29           C
ATOM    125  O   GLN A  17      35.638  34.562  24.017  0.73  3.69           O
ATOM    126  CB  GLN A  17      37.107  32.426  25.957  0.73  4.26           C
ATOM    127  CG  GLN A  17      36.981  31.185  25.093  0.73  5.23           C
ATOM    128  CD  GLN A  17      38.258  30.368  25.057  0.73  7.38           C
ATOM    129  OE1 GLN A  17      39.173  30.590  25.850  0.73  8.36           O
ATOM    130  NE2 GLN A  17      38.326  29.416  24.133  0.73  9.04           N
ATOM    131  N   ALA A  18      34.390  32.700  24.196  1.00  3.36           N
ATOM    132  CA  ALA A  18      33.704  32.907  22.928  1.00  3.89           C
ATOM    133  C   ALA A  18      32.711  34.051  23.063  1.00  4.05           C
ATOM    134  O   ALA A  18      32.548  34.852  22.145  1.00  4.91           O
ATOM    135  CB  ALA A  18      33.001  31.643  22.480  1.00  4.53           C
ATOM    136  N   LYS A  19      32.068  34.137  24.225  1.00  4.37           N
ATOM    137  CA  LYS A  19      31.101  35.195  24.484  1.00  5.39           C
ATOM    138  C   LYS A  19      31.805  36.537  24.378  1.00  5.25           C
ATOM    139  O   LYS A  19      31.232  37.516  23.899  1.00  5.52           O
ATOM    140  CB  LYS A  19      30.456  35.032  25.862  1.00  6.50           C
ATOM    141  CG  LYS A  19      29.397  36.074  26.182  1.00  7.77           C
ATOM    142  CD  LYS A  19      28.842  35.886  27.585  1.00 10.16           C
ATOM    143  CE  LYS A  19      28.157  34.536  27.730  1.00 12.49           C
ATOM    144  NZ  LYS A  19      27.618  34.333  29.103  1.00 15.57           N
ATOM    145  N   ALA A  20      33.054  36.577  24.827  1.00  5.38           N
ATOM    146  CA  ALA A  20      33.869  37.769  24.640  1.00  5.88           C
ATOM    147  C   ALA A  20      34.255  37.929  23.167  1.00  5.38           C
ATOM    148  O   ALA A  20      34.229  39.034  22.626  1.00  6.73           O
ATOM    149  CB  ALA A  20      35.111  37.708  25.514  1.00  6.65           C
ATOM    150  N   ALA A  21      34.611  36.817  22.526  1.00  4.87           N
ATOM    151  CA  ALA A  21      35.030  36.822  21.124  1.00  5.54           C
ATOM    152  C   ALA A  21      33.874  36.868  20.120  1.00  4.89           C
ATOM    153  O   ALA A  21      33.628  37.898  19.493  1.00  5.59           O
ATOM    154  CB  ALA A  21      35.904  35.606  20.846  1.00  6.30           C
ATOM    155  N   GLY A  22      33.169  35.747  19.974  1.00  4.70           N
ATOM    156  CA  GLY A  22      32.123  35.622  18.971  1.00  4.84           C
ATOM    157  C   GLY A  22      31.060  34.606  19.349  1.00  4.56           C
ATOM    158  O   GLY A  22      31.318  33.683  20.120  1.00  5.92           O
ATOM    159  N   ARG A  23      29.869  34.747  18.777  1.00  4.30           N
ATOM    160  CA  ARG A  23      28.710  34.023  19.289  1.00  4.97           C
ATOM    161  C   ARG A  23      28.116  32.970  18.352  1.00  5.19           C
ATOM    162  O   ARG A  23      28.051  31.798  18.708  1.00  5.70           O
ATOM    163  CB  ARG A  23      27.613  35.021  19.669  1.00  5.52           C
ATOM    164  CG  ARG A  23      26.401  34.386  20.333  1.00  6.50           C
ATOM    165  CD  ARG A  23      25.368  35.434  20.715  1.00  7.51           C
ATOM    166  NE  ARG A  23      24.219  34.845  21.397  1.00  8.98           N
ATOM    167  CZ  ARG A  23      24.140  34.672  22.713  1.00 10.56           C
ATOM    168  NH1 ARG A  23      23.055  34.128  23.248  1.00 10.81           N
ATOM    169  NH2 ARG A  23      25.145  35.043  23.494  1.00 11.93           N
ATOM    170  N   MET A  24      27.705  33.380  17.156  0.69  5.87           N
ATOM    171  CA  MET A  24      26.942  32.498  16.270  0.69  7.12           C
ATOM    172  C   MET A  24      27.678  31.243  15.787  0.69  6.14           C
ATOM    173  O   MET A  24      27.095  30.156  15.762  0.69  5.80           O
ATOM    174  CB  MET A  24      26.452  33.294  15.055  0.69  9.83           C
ATOM    175  CG  MET A  24      27.541  34.062  14.321  0.69 13.17           C
ATOM    176  SD  MET A  24      26.891  35.077  12.980  0.69 13.65           S
ATOM    177  CE  MET A  24      25.967  36.304  13.900  0.69 13.09           C
ATOM    178  N   ASP A  25      28.948  31.378  15.421  1.00  6.26           N
ATOM    179  CA  ASP A  25      29.705  30.234  14.921  1.00  6.70           C
ATOM    180  C   ASP A  25      29.990  29.217  16.025  1.00  5.34           C
ATOM    181  O   ASP A  25      29.846  28.007  15.825  1.00  5.81           O
ATOM    182  CB  ASP A  25      31.016  30.700  14.281  1.00  9.38           C
ATOM    183  CG  ASP A  25      31.838  31.577  15.205  1.00 13.52           C
ATOM    184  OD1 ASP A  25      31.266  32.128  16.169  1.00 14.07           O
ATOM    185  OD2 ASP A  25      33.057  31.716  14.967  1.00 17.20           O
ATOM    186  N   GLU A  26      30.369  29.718  17.195  0.67  4.76           N
ATOM    187  CA  GLU A  26      30.676  28.861  18.332  0.67  4.83           C
ATOM    188  C   GLU A  26      29.412  28.186  18.854  0.67  4.62           C
ATOM    189  O   GLU A  26      29.442  27.026  19.263  0.67  4.93           O
ATOM    190  CB  GLU A  26      31.358  29.666  19.440  0.67  5.41           C
ATOM    191  CG  GLU A  26      31.896  28.827  20.587  0.67  6.20           C
ATOM    192  CD  GLU A  26      30.908  28.695  21.727  0.67  7.05           C
ATOM    193  OE1 GLU A  26      29.820  29.303  21.645  0.67  7.13           O
ATOM    194  OE2 GLU A  26      31.224  27.991  22.709  0.67  8.43           O
ATOM    195  N   VAL A  27      28.304  28.920  18.836  1.00  4.54           N
ATOM    196  CA  VAL A  27      27.020  28.373  19.257  1.00  5.02           C
ATOM    197  C   VAL A  27      26.564  27.299  18.274  1.00  4.94           C
ATOM    198  O   VAL A  27      26.014  26.277  18.678  1.00  5.05           O
ATOM    199  CB  VAL A  27      25.941  29.477  19.381  1.00  5.29           C
ATOM    200  CG1 VAL A  27      26.139  30.263  20.668  1.00  5.41           C
ATOM    201  CG2 VAL A  27      24.541  28.882  19.346  1.00  6.00           C
ATOM    202  N   ARG A  28      26.816  27.519  16.987  1.00  5.20           N
ATOM    203  CA  ARG A  28      26.446  26.537  15.971  1.00  5.54           C
ATOM    204  C   ARG A  28      27.274  25.259  16.109  1.00  4.76           C
ATOM    205  O   ARG A  28      26.742  24.146  16.012  1.00  5.46           O
ATOM    206  CB  ARG A  28      26.617  27.126  14.569  1.00  6.82           C
ATOM    207  CG  ARG A  28      26.209  26.187  13.446  1.00  9.78           C
ATOM    208  CD  ARG A  28      26.389  26.843  12.087  1.00 13.05           C
ATOM    209  NE  ARG A  28      25.989  25.959  10.996  1.00 17.58           N
ATOM    210  CZ  ARG A  28      26.803  25.098  10.395  1.00 20.46           C
ATOM    211  NH1 ARG A  28      26.353  24.333   9.410  1.00 20.45           N
ATOM    212  NH2 ARG A  28      28.069  25.001  10.778  1.00 21.92           N
ATOM    213  N   THR A  29      28.570  25.421  16.364  1.00  4.62           N
ATOM    214  CA  THR A  29      29.451  24.272  16.550  1.00  5.38           C
ATOM    215  C   THR A  29      29.069  23.516  17.817  1.00  4.39           C
ATOM    216  O   THR A  29      29.128  22.286  17.862  1.00  5.02           O
ATOM    217  CB  THR A  29      30.932  24.687  16.629  1.00  7.77           C
ATOM    218  OG1 THR A  29      31.098  25.687  17.643  1.00  9.68           O
ATOM    219  CG2 THR A  29      31.405  25.239  15.293  1.00  8.93           C
ATOM    220  N   LEU A  30      28.673  24.262  18.843  1.00  4.10           N
ATOM    221  CA  LEU A  30      28.225  23.668  20.095  1.00  4.03           C
ATOM    222  C   LEU A  30      26.920  22.911  19.897  1.00  4.40           C
ATOM    223  O   LEU A  30      26.685  21.894  20.540  1.00  4.33           O
ATOM    224  CB  LEU A  30      28.056  24.737  21.175  1.00  4.41           C
ATOM    225  CG  LEU A  30      29.156  24.767  22.237  1.00  5.82           C
ATOM    226  CD1 LEU A  30      30.514  25.010  21.597  1.00  7.43           C
ATOM    227  CD2 LEU A  30      28.853  25.816  23.293  1.00  7.81           C
ATOM    228  N   GLN A  31      26.067  23.421  19.015  1.00  4.65           N
ATOM    229  CA  GLN A  31      24.813  22.752  18.697  1.00  5.33           C
ATOM    230  C   GLN A  31      25.085  21.453  17.952  1.00  5.02           C
ATOM    231  O   GLN A  31      24.417  20.445  18.186  1.00  5.56           O
ATOM    232  CB  GLN A  31      23.902  23.660  17.868  1.00  6.58           C
ATOM    233  CG  GLN A  31      23.231  24.766  18.667  1.00  9.50           C
ATOM    234  CD  GLN A  31      22.343  25.647  17.810  1.00 12.70           C
ATOM    235  OE1 GLN A  31      22.452  25.652  16.584  1.00 14.44           O
ATOM    236  NE2 GLN A  31      21.458  26.399  18.454  1.00 13.69           N
ATOM    237  N   GLU A  32      26.072  21.475  17.061  1.00  5.72           N
ATOM    238  CA  GLU A  32      26.439  20.268  16.326  1.00  6.90           C
ATOM    239  C   GLU A  32      27.043  19.221  17.261  1.00  5.82           C
ATOM    240  O   GLU A  32      26.741  18.028  17.155  1.00  6.63           O
ATOM    241  CB  GLU A  32      27.420  20.600  15.200  1.00 10.01           C
ATOM    242  CG  GLU A  32      26.842  21.491  14.114  1.00 16.02           C
ATOM    243  CD  GLU A  32      27.844  21.802  13.019  1.00 22.44           C
ATOM    244  OE1 GLU A  32      29.028  21.435  13.174  1.00 25.00           O
ATOM    245  OE2 GLU A  32      27.448  22.413  12.005  1.00 24.85           O
ATOM    246  N   ASN A  33      27.880  19.678  18.188  1.00  5.36           N
ATOM    247  CA  ASN A  33      28.513  18.787  19.154  1.00  5.56           C
ATOM    248  C   ASN A  33      27.501  18.199  20.132  1.00  5.07           C
ATOM    249  O   ASN A  33      27.587  17.029  20.503  1.00  6.19           O
ATOM    250  CB  ASN A  33      29.613  19.524  19.921  1.00  6.47           C
ATOM    251  CG  ASN A  33      30.768  19.936  19.030  1.00  8.34           C
ATOM    252  OD1 ASN A  33      31.035  19.304  18.008  1.00 11.36           O
ATOM    253  ND2 ASN A  33      31.461  21.002  19.415  1.00  8.04           N
ATOM    254  N   LEU A  34      26.543  19.020  20.547  1.00  4.51           N
ATOM    255  CA  LEU A  34      25.489  18.576  21.449  1.00  4.72           C
ATOM    256  C   LEU A  34      24.557  17.597  20.749  1.00  4.80           C
ATOM    257  O   LEU A  34      24.075  16.645  21.360  1.00  4.90           O
ATOM    258  CB  LEU A  34      24.696  19.769  21.988  1.00  4.81           C
ATOM    259  CG  LEU A  34      25.051  20.247  23.398  1.00  4.99           C
ATOM    260  CD1 LEU A  34      26.525  20.610  23.505  1.00  5.66           C
ATOM    261  CD2 LEU A  34      24.175  21.425  23.799  1.00  6.50           C
ATOM    262  N   HIS A  35      24.299  17.838  19.467  1.00  5.03           N
ATOM    263  CA  HIS A  35      23.442  16.949  18.691  1.00  5.85           C
ATOM    264  C   HIS A  35      24.105  15.596  18.443  1.00  5.91           C
ATOM    265  O   HIS A  35      23.460  14.554  18.568  1.00  6.51           O
ATOM    266  CB  HIS A  35      23.061  17.597  17.357  1.00  7.35           C
ATOM    267  CG  HIS A  35      21.980  18.626  17.472  1.00 10.07           C
ATOM    268  ND1 HIS A  35      22.198  19.880  18.001  1.00 13.24           N
ATOM    269  CD2 HIS A  35      20.672  18.587  17.125  1.00 10.94           C
ATOM    270  CE1 HIS A  35      21.071  20.569  17.975  1.00 14.19           C
ATOM    271  NE2 HIS A  35      20.130  19.807  17.449  1.00 13.06           N
ATOM    272  N   GLN A  36      25.393  15.607  18.107  1.00  5.86           N
ATOM    273  CA  GLN A  36      26.105  14.353  17.876  1.00  7.12           C
ATOM    274  C   GLN A  36      26.292  13.595  19.191  1.00  5.57           C
ATOM    275  O   GLN A  36      26.231  12.363  19.218  1.00  6.15           O
ATOM    276  CB  GLN A  36      27.454  14.599  17.187  1.00 10.81           C
ATOM    277  CG  GLN A  36      28.480  15.354  18.009  1.00 15.82           C
ATOM    278  CD  GLN A  36      29.782  15.569  17.262  1.00 20.43           C
ATOM    279  OE1 GLN A  36      29.786  16.007  16.112  1.00 21.72           O
ATOM    280  NE2 GLN A  36      30.896  15.259  17.915  1.00 22.23           N
ATOM    281  N   LEU A  37      26.508  14.332  20.278  1.00  4.79           N
ATOM    282  CA  LEU A  37      26.654  13.725  21.597  1.00  5.02           C
ATOM    283  C   LEU A  37      25.338  13.101  22.046  1.00  4.81           C
ATOM    284  O   LEU A  37      25.320  12.023  22.640  1.00  5.11           O
ATOM    285  CB  LEU A  37      27.123  14.760  22.622  1.00  5.48           C
ATOM    286  CG  LEU A  37      27.185  14.318  24.086  1.00  7.48           C
ATOM    287  CD1 LEU A  37      28.176  13.180  24.270  1.00  8.34           C
ATOM    288  CD2 LEU A  37      27.539  15.492  24.986  1.00  9.38           C
ATOM    289  N   MET A  38      24.237  13.784  21.751  1.00  5.10           N
ATOM    290  CA  MET A  38      22.913  13.286  22.098  0.60  5.87           C
ATOM    291  C   MET A  38      22.569  12.054  21.271  1.00  5.55           C
ATOM    292  O   MET A  38      21.963  11.108  21.775  1.00  5.83           O
ATOM    293  CB  MET A  38      21.856  14.374  21.892  0.60  7.11           C
ATOM    294  CG  MET A  38      20.443  13.946  22.255  0.60  8.46           C
ATOM    295  SD  MET A  38      19.234  15.263  22.019  0.60 10.21           S
ATOM    296  CE  MET A  38      19.348  15.514  20.249  0.60 11.26           C
ATOM    297  N   HIS A  39      22.962  12.067  20.001  1.00  5.90           N
ATOM    298  CA  HIS A  39      22.700  10.937  19.117  1.00  6.60           C
ATOM    299  C   HIS A  39      23.515   9.706  19.503  1.00  6.76           C
ATOM    300  O   HIS A  39      22.995   8.589  19.502  1.00  7.35           O
ATOM    301  CB  HIS A  39      22.987  11.318  17.663  1.00  7.90           C
ATOM    302  CG  HIS A  39      21.937  12.189  17.047  1.00  9.99           C
ATOM    303  ND1 HIS A  39      21.807  13.527  17.349  1.00 11.79           N
ATOM    304  CD2 HIS A  39      20.966  11.912  16.144  1.00 10.09           C
ATOM    305  CE1 HIS A  39      20.802  14.037  16.660  1.00 11.60           C
ATOM    306  NE2 HIS A  39      20.275  13.078  15.921  1.00 10.84           N
ATOM    307  N   GLU A  40      24.787   9.905  19.838  1.00  6.24           N
ATOM    308  CA  GLU A  40      25.634   8.786  20.240  1.00  7.45           C
ATOM    309  C   GLU A  40      25.229   8.261  21.617  1.00  6.69           C
ATOM    310  O   GLU A  40      25.306   7.060  21.874  1.00  7.99           O
ATOM    311  CB  GLU A  40      27.117   9.177  20.221  1.00  8.91           C
ATOM    312  CG  GLU A  40      27.533  10.220  21.241  1.00 12.58           C
ATOM    313  CD  GLU A  40      29.006  10.566  21.145  1.00 17.22           C
ATOM    314  OE1 GLU A  40      29.755   9.803  20.500  1.00 19.50           O
ATOM    315  OE2 GLU A  40      29.414  11.601  21.712  1.00 19.12           O
ATOM    316  N   TYR A  41      24.800   9.160  22.499  1.00  6.31           N
ATOM    317  CA  TYR A  41      24.342   8.761  23.827  1.00  6.52           C
ATOM    318  C   TYR A  41      23.036   7.980  23.732  1.00  6.93           C
ATOM    319  O   TYR A  41      22.826   7.011  24.461  1.00  7.89           O
ATOM    320  CB  TYR A  41      24.164   9.982  24.731  1.00  6.84           C
ATOM    321  CG  TYR A  41      23.671   9.653  26.123  1.00  7.08           C
ATOM    322  CD1 TYR A  41      24.546   9.195  27.100  1.00  8.09           C
ATOM    323  CD2 TYR A  41      22.333   9.805  26.462  1.00  8.31           C
ATOM    324  CE1 TYR A  41      24.102   8.894  28.373  1.00  8.88           C
ATOM    325  CE2 TYR A  41      21.879   9.506  27.733  1.00  8.84           C
ATOM    326  CZ  TYR A  41      22.768   9.051  28.684  1.00  9.01           C
ATOM    327  OH  TYR A  41      22.321   8.753  29.951  1.00  9.91           O
ATOM    328  N   PHE A  42      22.160   8.412  22.829  1.00  7.44           N
ATOM    329  CA  PHE A  42      20.888   7.733  22.609  1.00  9.29           C
ATOM    330  C   PHE A  42      21.110   6.371  21.963  1.00 11.50           C
ATOM    331  O   PHE A  42      20.420   5.402  22.282  1.00 13.50           O
ATOM    332  CB  PHE A  42      19.964   8.589  21.740  1.00  9.49           C
ATOM    333  CG  PHE A  42      18.635   7.948  21.453  1.00  9.99           C
ATOM    334  CD1 PHE A  42      17.617   7.983  22.392  1.00 11.43           C
ATOM    335  CD2 PHE A  42      18.400   7.318  20.241  1.00 10.35           C
ATOM    336  CE1 PHE A  42      16.393   7.397  22.131  1.00 11.84           C
ATOM    337  CE2 PHE A  42      17.178   6.730  19.974  1.00 11.43           C
ATOM    338  CZ  PHE A  42      16.174   6.770  20.921  1.00 12.29           C
ATOM    339  N   GLN A  43      22.076   6.305  21.052  1.00 11.97           N
ATOM    340  CA  GLN A  43      22.408   5.056  20.376  1.00 13.21           C
ATOM    341  C   GLN A  43      23.035   4.058  21.345  1.00 16.37           C
ATOM    342  O   GLN A  43      22.759   2.860  21.283  1.00 17.39           O
ATOM    343  CB  GLN A  43      23.353   5.318  19.202  1.00 11.79           C
ATOM    344  CG  GLN A  43      23.738   4.071  18.421  1.00 11.86           C
ATOM    345  CD  GLN A  43      24.676   4.372  17.268  1.00 12.53           C
ATOM    346  OE1 GLN A  43      24.443   5.296  16.489  1.00 14.19           O
ATOM    347  NE2 GLN A  43      25.744   3.592  17.155  1.00 13.65           N
ATOM    348  N   GLN A  44      23.879   4.562  22.241  1.00 19.32           N
ATOM    349  CA  GLN A  44      24.531   3.721  23.238  1.00 22.77           C
ATOM    350  C   GLN A  44      23.530   3.198  24.263  1.00 25.16           C
ATOM    351  O   GLN A  44      23.747   2.157  24.882  1.00 27.03           O
ATOM    352  CB  GLN A  44      25.648   4.493  23.942  1.00 23.69           C
TER
"""

tst_02_start_lines = """\
CRYST1   39.979   38.891   33.998  90.00  90.00  90.00 P 1
SCALE1      0.025013  0.000000  0.000000        0.00000
SCALE2      0.000000  0.025713  0.000000        0.00000
SCALE3      0.000000  0.000000  0.029413        0.00000
ATOM      1  N   ALA A  21       8.035  20.299   4.150  1.00 33.96           N
ATOM      2  CA  ALA A  21       9.085  20.780   5.040  1.00 32.69           C
ATOM      3  C   ALA A  21       9.114  19.980   6.338  1.00 32.55           C
ATOM      4  O   ALA A  21       8.257  20.152   7.204  1.00 33.56           O
ATOM      5  CB  ALA A  21       8.893  22.260   5.334  1.00 33.18           C
ATOM      6  N   ALA A  22      10.106  19.104   6.465  1.00 31.24           N
ATOM      7  CA  ALA A  22      10.248  18.275   7.655  1.00 30.10           C
ATOM      8  C   ALA A  22      11.377  18.783   8.546  1.00 29.32           C
ATOM      9  O   ALA A  22      12.549  18.724   8.173  1.00 30.19           O
ATOM     10  CB  ALA A  22      10.491  16.826   7.266  1.00 30.34           C
ATOM     11  N   ALA A  23      11.017  19.283   9.723  1.00 27.76           N
ATOM     12  CA  ALA A  23      11.998  19.805  10.666  1.00 26.26           C
ATOM     13  C   ALA A  23      11.854  19.144  12.033  1.00 23.38           C
ATOM     14  O   ALA A  23      11.027  18.251  12.217  1.00 25.31           O
ATOM     15  CB  ALA A  23      11.863  21.315  10.790  1.00 27.05           C
ATOM     16  N   ALA A  24      12.663  19.590  12.988  1.00 19.15           N
ATOM     17  CA  ALA A  24      12.633  19.039  14.337  1.00 17.40           C
ATOM     18  C   ALA A  24      11.922  19.980  15.304  1.00 15.24           C
ATOM     19  O   ALA A  24      12.393  21.086  15.567  1.00 15.15           O
ATOM     20  CB  ALA A  24      14.044  18.750  14.822  1.00 16.09           C
ATOM     21  N   ALA A  25      10.786  19.533  15.829  1.00 13.99           N
ATOM     22  CA  ALA A  25      10.015  20.329  16.776  1.00 13.94           C
ATOM     23  C   ALA A  25      10.239  19.843  18.204  1.00 12.79           C
ATOM     24  O   ALA A  25      10.365  18.643  18.449  1.00 11.77           O
ATOM     25  CB  ALA A  25       8.536  20.287  16.426  1.00 14.72           C
ATOM     26  N   ALA A  26      10.287  20.782  19.143  1.00 11.97           N
ATOM     27  CA  ALA A  26      10.504  20.451  20.547  1.00 12.04           C
ATOM     28  C   ALA A  26       9.246  19.858  21.172  1.00 10.98           C
ATOM     29  O   ALA A  26       8.158  20.424  21.059  1.00 12.65           O
ATOM     30  CB  ALA A  26      10.949  21.684  21.319  1.00 11.63           C
ATOM     31  N   ALA A  27       9.402  18.715  21.831  1.00 10.67           N
ATOM     32  CA  ALA A  27       8.280  18.044  22.478  1.00 12.41           C
ATOM     33  C   ALA A  27       8.017  18.628  23.862  1.00 13.93           C
ATOM     34  O   ALA A  27       8.706  19.549  24.300  1.00 14.04           O
ATOM     35  CB  ALA A  27       8.541  16.549  22.574  1.00 12.92           C
ATOM     36  N   ALA A  28       7.014  18.086  24.546  1.00 15.45           N
ATOM     37  CA  ALA A  28       6.660  18.549  25.882  1.00 17.17           C
ATOM     38  C   ALA A  28       7.601  17.969  26.932  1.00 16.56           C
ATOM     39  O   ALA A  28       7.858  16.765  26.952  1.00 18.23           O
ATOM     40  CB  ALA A  28       5.218  18.186  26.203  1.00 17.15           C
ATOM     41  N   GLY A  29       8.113  18.833  27.803  1.00 18.72           N
ATOM     42  CA  GLY A  29       9.016  18.408  28.856  1.00 18.52           C
ATOM     43  C   GLY A  29      10.462  18.764  28.570  1.00 18.48           C
ATOM     44  O   GLY A  29      11.301  18.760  29.470  1.00 19.65           O
ATOM     45  N   ALA A  30      10.753  19.073  27.311  1.00 17.32           N
ATOM     46  CA  ALA A  30      12.107  19.433  26.905  1.00 16.80           C
ATOM     47  C   ALA A  30      12.217  20.928  26.624  1.00 16.52           C
ATOM     48  O   ALA A  30      11.285  21.541  26.102  1.00 17.70           O
ATOM     49  CB  ALA A  30      12.525  18.631  25.683  1.00 15.92           C
ATOM     50  N   ALA A  31      13.360  21.509  26.972  1.00 17.28           N
ATOM     51  CA  ALA A  31      13.591  22.933  26.761  1.00 16.91           C
ATOM     52  C   ALA A  31      14.726  23.168  25.770  1.00 16.03           C
ATOM     53  O   ALA A  31      15.327  22.221  25.263  1.00 14.98           O
ATOM     54  CB  ALA A  31      13.890  23.623  28.083  1.00 17.76           C
ATOM     55  N   ALA A  32      15.014  24.438  25.499  1.00 16.22           N
ATOM     56  CA  ALA A  32      16.077  24.804  24.571  1.00 16.19           C
ATOM     57  C   ALA A  32      17.454  24.603  25.197  1.00 14.39           C
ATOM     58  O   ALA A  32      17.594  24.584  26.420  1.00 15.02           O
ATOM     59  CB  ALA A  32      15.908  26.246  24.116  1.00 18.18           C
ATOM     60  N   ALA A  33      18.466  24.453  24.349  1.00 13.72           N
ATOM     61  CA  ALA A  33      19.836  24.268  24.814  1.00 13.64           C
ATOM     62  C   ALA A  33      20.441  25.587  25.284  1.00 12.50           C
ATOM     63  O   ALA A  33      20.243  26.629  24.660  1.00 12.22           O
ATOM     64  CB  ALA A  33      20.690  23.656  23.714  1.00 14.15           C
ATOM     65  N   ALA A  34      21.178  25.534  26.389  1.00 12.12           N
ATOM     66  CA  ALA A  34      21.807  26.725  26.950  1.00 12.41           C
ATOM     67  C   ALA A  34      23.098  27.068  26.213  1.00 13.60           C
ATOM     68  O   ALA A  34      24.003  26.240  26.107  1.00 15.68           O
ATOM     69  CB  ALA A  34      22.080  26.530  28.433  1.00 12.66           C
ATOM     70  N   ALA A  35      23.176  28.295  25.706  1.00 14.17           N
ATOM     71  CA  ALA A  35      24.355  28.754  24.981  1.00 16.12           C
ATOM     72  C   ALA A  35      25.475  29.145  25.941  1.00 15.11           C
ATOM     73  O   ALA A  35      25.219  29.625  27.045  1.00 16.45           O
ATOM     74  CB  ALA A  35      23.998  29.925  24.078  1.00 16.47           C
ATOM     75  N   GLY A  36      26.715  28.936  25.512  1.00 14.18           N
ATOM     76  CA  GLY A  36      27.869  29.252  26.333  1.00 13.93           C
ATOM     77  C   GLY A  36      28.258  30.716  26.267  1.00 13.16           C
ATOM     78  O   GLY A  36      27.771  31.461  25.417  1.00 12.39           O
ATOM     79  N   ALA A  37      29.142  31.128  27.171  1.00 14.69           N
ATOM     80  CA  ALA A  37      29.593  32.514  27.230  1.00 16.56           C
ATOM     81  C   ALA A  37      30.896  32.713  26.461  1.00 18.09           C
ATOM     82  O   ALA A  37      31.452  33.812  26.441  1.00 19.82           O
ATOM     83  CB  ALA A  37      29.761  32.952  28.677  1.00 17.45           C
ATOM     84  N   ALA A  38      31.380  31.645  25.835  1.00 20.32           N
ATOM     85  CA  ALA A  38      32.634  31.691  25.089  1.00 19.19           C
ATOM     86  C   ALA A  38      32.523  32.591  23.861  1.00 19.61           C
ATOM     87  O   ALA A  38      31.430  32.814  23.340  1.00 18.87           O
ATOM     88  CB  ALA A  38      33.057  30.289  24.680  1.00 20.89           C
ATOM     89  N   ALA A  39      33.662  33.103  23.405  1.00 18.72           N
ATOM     90  CA  ALA A  39      33.693  33.988  22.245  1.00 19.33           C
ATOM     91  C   ALA A  39      33.919  33.202  20.957  1.00 18.66           C
ATOM     92  O   ALA A  39      33.897  33.765  19.863  1.00 21.79           O
ATOM     93  CB  ALA A  39      34.772  35.046  22.416  1.00 20.01           C
ATOM     94  N   ALA A  40      34.135  31.898  21.097  1.00 17.11           N
ATOM     95  CA  ALA A  40      34.309  31.020  19.946  1.00 17.00           C
ATOM     96  C   ALA A  40      33.079  30.140  19.765  1.00 16.01           C
ATOM     97  O   ALA A  40      32.433  29.760  20.742  1.00 16.18           O
ATOM     98  CB  ALA A  40      35.558  30.168  20.108  1.00 17.26           C
ATOM     99  N   ALA A  41      32.753  29.817  18.518  1.00 15.99           N
ATOM    100  CA  ALA A  41      31.569  29.015  18.241  1.00 16.37           C
ATOM    101  C   ALA A  41      31.823  27.542  18.541  1.00 15.52           C
ATOM    102  O   ALA A  41      32.953  27.155  18.845  1.00 18.11           O
ATOM    103  CB  ALA A  41      31.133  29.194  16.795  1.00 17.06           C
ATOM    104  N   ALA A  42      30.774  26.729  18.414  1.00 13.73           N
ATOM    105  CA  ALA A  42      30.833  25.293  18.719  1.00 13.40           C
ATOM    106  C   ALA A  42      29.475  24.631  18.468  1.00 12.31           C
ATOM    107  O   ALA A  42      28.435  25.294  18.493  1.00 13.00           O
ATOM    108  CB  ALA A  42      31.299  25.047  20.147  1.00 14.91           C
ATOM    109  N   ALA A  43      29.490  23.325  18.212  1.00 12.74           N
ATOM    110  CA  ALA A  43      28.299  22.611  17.753  1.00 12.74           C
ATOM    111  C   ALA A  43      27.575  21.788  18.816  1.00 11.86           C
ATOM    112  O   ALA A  43      28.147  20.872  19.408  1.00 12.94           O
ATOM    113  CB  ALA A  43      28.672  21.710  16.582  1.00 13.72           C
ATOM    114  N   ALA A  44      26.306  22.127  19.048  1.00  9.87           N
ATOM    115  CA  ALA A  44      25.485  21.399  20.010  1.00  9.48           C
ATOM    116  C   ALA A  44      24.361  20.643  19.306  1.00  9.29           C
ATOM    117  O   ALA A  44      23.451  21.248  18.741  1.00  9.63           O
ATOM    118  CB  ALA A  44      24.911  22.348  21.050  1.00 11.24           C
ATOM    119  N   ALA A  45      24.424  19.317  19.347  1.00  8.42           N
ATOM    120  CA  ALA A  45      23.416  18.491  18.692  1.00  9.05           C
ATOM    121  C   ALA A  45      22.579  17.737  19.718  1.00  9.11           C
ATOM    122  O   ALA A  45      23.069  16.837  20.399  1.00 10.48           O
ATOM    123  CB  ALA A  45      24.073  17.520  17.725  0.50  9.47           C
ATOM    125  N   ALA A  46      21.309  18.115  19.818  1.00  9.29           N
ATOM    126  CA  ALA A  46      20.391  17.499  20.768  1.00  9.25           C
ATOM    127  C   ALA A  46      19.256  16.778  20.049  1.00  9.68           C
ATOM    128  O   ALA A  46      18.431  17.404  19.381  1.00  9.10           O
ATOM    129  CB  ALA A  46      19.834  18.545  21.721  1.00 10.94           C
ATOM    130  N   ALA A  47      19.225  15.456  20.183  1.00  9.82           N
ATOM    131  CA  ALA A  47      18.183  14.649  19.562  1.00 10.81           C
ATOM    132  C   ALA A  47      17.313  13.981  20.621  1.00 11.43           C
ATOM    133  O   ALA A  47      17.767  13.093  21.342  1.00 12.52           O
ATOM    134  CB  ALA A  47      18.795  13.607  18.642  1.00 12.42           C
ATOM    135  N   ALA A  48      16.060  14.415  20.708  1.00 10.26           N
ATOM    136  CA  ALA A  48      15.122  13.861  21.676  1.00 11.47           C
ATOM    137  C   ALA A  48      14.029  13.061  20.977  1.00 11.60           C
ATOM    138  O   ALA A  48      13.231  13.613  20.220  1.00 12.19           O
ATOM    139  CB  ALA A  48      14.513  14.970  22.519  1.00 12.77           C
ATOM    140  N   GLY A  49      13.997  11.758  21.239  1.00 12.74           N
ATOM    141  CA  GLY A  49      13.020  10.881  20.622  1.00 11.60           C
ATOM    142  C   GLY A  49      13.227  10.734  19.127  1.00 10.42           C
ATOM    143  O   GLY A  49      14.313  10.378  18.672  1.00 11.59           O
ATOM    144  N   ALA A  50      12.177  11.011  18.361  1.00 11.29           N
ATOM    145  CA  ALA A  50      12.225  10.874  16.910  1.00 11.34           C
ATOM    146  C   ALA A  50      12.657  12.172  16.235  1.00 12.16           C
ATOM    147  O   ALA A  50      12.687  12.263  15.008  1.00 13.13           O
ATOM    148  CB  ALA A  50      10.871  10.428  16.378  1.00 12.07           C
ATOM    149  N   ALA A  51      12.990  13.175  17.041  1.00 10.41           N
ATOM    150  CA  ALA A  51      13.381  14.478  16.513  1.00 10.68           C
ATOM    151  C   ALA A  51      14.841  14.792  16.822  1.00  9.61           C
ATOM    152  O   ALA A  51      15.298  14.623  17.952  1.00 10.82           O
ATOM    153  CB  ALA A  51      12.477  15.566  17.072  1.00 12.11           C
ATOM    154  N   ALA A  52      15.568  15.249  15.807  1.00  9.76           N
ATOM    155  CA  ALA A  52      16.974  15.603  15.959  1.00  9.58           C
ATOM    156  C   ALA A  52      17.203  17.074  15.628  1.00  9.17           C
ATOM    157  O   ALA A  52      17.052  17.491  14.479  1.00 10.60           O
ATOM    158  CB  ALA A  52      17.843  14.718  15.079  1.00 10.97           C
ATOM    159  N   ALA A  53      17.571  17.855  16.638  1.00  9.58           N
ATOM    160  CA  ALA A  53      17.791  19.286  16.461  1.00  9.19           C
ATOM    161  C   ALA A  53      19.252  19.653  16.693  1.00  8.44           C
ATOM    162  O   ALA A  53      19.766  19.511  17.802  1.00  9.51           O
ATOM    163  CB  ALA A  53      16.891  20.080  17.395  1.00 11.00           C
ATOM    164  N   ALA A  54      19.918  20.128  15.645  1.00  9.12           N
ATOM    165  CA  ALA A  54      21.327  20.490  15.746  1.00 10.31           C
ATOM    166  C   ALA A  54      21.531  21.995  15.606  1.00 11.22           C
ATOM    167  O   ALA A  54      21.358  22.566  14.528  1.00 11.54           O
ATOM    168  CB  ALA A  54      22.139  19.747  14.695  0.70 11.35           C
ATOM    170  N   ALA A  55      21.900  22.624  16.716  1.00 10.84           N
ATOM    171  CA  ALA A  55      22.157  24.058  16.771  1.00 10.72           C
ATOM    172  C   ALA A  55      23.597  24.312  17.198  1.00 11.99           C
ATOM    173  O   ALA A  55      24.025  23.856  18.265  1.00 12.79           O
ATOM    174  CB  ALA A  55      21.187  24.740  17.722  1.00 10.97           C
ATOM    175  N   ALA A  56      24.372  25.000  16.367  1.00 12.74           N
ATOM    176  CA  ALA A  56      25.747  25.233  16.770  1.00 13.08           C
ATOM    177  C   ALA A  56      26.096  26.690  17.034  1.00 12.57           C
ATOM    178  O   ALA A  56      26.352  27.451  16.101  1.00 13.19           O
ATOM    179  CB  ALA A  56      26.668  24.693  15.689  1.00 15.32           C
ATOM    180  N   GLY A  57      26.109  27.080  18.306  1.00 12.52           N
ATOM    181  CA  GLY A  57      26.797  28.286  18.722  1.00 12.40           C
ATOM    182  C   GLY A  57      27.895  27.915  19.699  1.00 13.18           C
ATOM    183  O   GLY A  57      28.923  28.579  19.811  1.00 12.99           O
ATOM    184  N   ALA A  58      27.685  26.777  20.355  1.00 13.41           N
ATOM    185  CA  ALA A  58      28.465  26.401  21.529  1.00 14.00           C
ATOM    186  C   ALA A  58      28.354  24.905  21.806  1.00 14.24           C
ATOM    187  O   ALA A  58      27.435  24.246  21.326  1.00 15.91           O
ATOM    188  CB  ALA A  58      28.015  27.201  22.742  1.00 15.02           C
ATOM    189  N   ALA A  59      29.297  24.374  22.577  1.00 13.99           N
ATOM    190  CA  ALA A  59      29.253  22.974  22.983  1.00 13.59           C
ATOM    191  C   ALA A  59      29.906  22.777  24.347  1.00 15.86           C
ATOM    192  O   ALA A  59      30.922  23.400  24.652  1.00 15.86           O
ATOM    193  CB  ALA A  59      29.928  22.097  21.941  1.00 12.76           C
ATOM    194  N   ALA A  60      29.318  21.909  25.163  1.00 17.03           N
ATOM    195  CA  ALA A  60      29.899  21.568  26.456  1.00 17.98           C
ATOM    196  C   ALA A  60      29.836  20.066  26.706  1.00 17.64           C
ATOM    197  O   ALA A  60      28.752  19.486  26.776  1.00 18.56           O
ATOM    198  CB  ALA A  60      29.191  22.322  27.570  0.60 18.61           C
ATOM    200  N   GLY A  61      31.001  19.441  26.842  1.00 18.36           N
ATOM    201  CA  GLY A  61      31.078  18.021  27.136  1.00 16.97           C
ATOM    202  C   GLY A  61      30.562  17.140  26.015  1.00 15.14           C
ATOM    203  O   GLY A  61      30.170  17.627  24.954  1.00 15.23           O
ATOM    204  N   GLY A  62      30.568  15.832  26.250  1.00 13.16           N
ATOM    205  CA  GLY A  62      30.013  14.883  25.304  1.00 11.15           C
ATOM    206  C   GLY A  62      30.870  14.653  24.074  1.00 10.98           C
ATOM    207  O   GLY A  62      32.096  14.588  24.156  1.00 12.09           O
ATOM    208  N   ALA A  63      30.210  14.530  22.926  1.00  9.78           N
ATOM    209  CA  ALA A  63      30.884  14.231  21.668  1.00 10.89           C
ATOM    210  C   ALA A  63      30.175  14.913  20.503  1.00 11.10           C
ATOM    211  O   ALA A  63      29.324  15.779  20.708  1.00 10.76           O
ATOM    212  CB  ALA A  63      30.952  12.729  21.445  1.00 10.28           C
ATOM    213  N   ALA A  64      30.541  14.524  19.284  1.00 11.99           N
ATOM    214  CA  ALA A  64      29.927  15.064  18.072  1.00 14.29           C
ATOM    215  C   ALA A  64      28.409  14.880  18.068  1.00 13.74           C
ATOM    216  O   ALA A  64      27.693  15.621  17.390  1.00 15.77           O
ATOM    217  CB  ALA A  64      30.538  14.415  16.840  1.00 15.98           C
ATOM    218  N   ALA A  65      27.945  13.859  18.789  1.00 12.96           N
ATOM    219  CA  ALA A  65      26.528  13.647  19.102  1.00 14.79           C
ATOM    220  C   ALA A  65      25.710  13.132  17.918  1.00 12.45           C
ATOM    221  O   ALA A  65      24.622  12.590  18.107  1.00 12.02           O
ATOM    222  CB  ALA A  65      25.901  14.929  19.657  1.00 14.67           C
ATOM    223  N   ALA A  66      26.223  13.303  16.704  1.00 12.45           N
ATOM    224  CA  ALA A  66      25.522  12.836  15.512  1.00 12.26           C
ATOM    225  C   ALA A  66      25.481  11.311  15.461  1.00 11.46           C
ATOM    226  O   ALA A  66      24.461  10.716  15.103  1.00 11.40           O
ATOM    227  CB  ALA A  66      26.180  13.391  14.259  1.00 14.48           C
ATOM    228  N   GLY A  67      26.593  10.684  15.834  1.00 11.42           N
ATOM    229  CA  GLY A  67      26.682   9.236  15.855  1.00 11.67           C
ATOM    230  C   GLY A  67      25.800   8.640  16.932  1.00 11.68           C
ATOM    231  O   GLY A  67      25.177   7.598  16.732  1.00 12.32           O
ATOM    232  N   ALA A  68      25.749   9.307  18.080  1.00 11.77           N
ATOM    233  CA  ALA A  68      24.907   8.871  19.187  1.00 12.05           C
ATOM    234  C   ALA A  68      23.433   9.040  18.836  1.00 11.27           C
ATOM    235  O   ALA A  68      22.597   8.217  19.208  1.00 11.60           O
ATOM    236  CB  ALA A  68      25.247   9.644  20.451  1.00 13.97           C
ATOM    237  N   ALA A  69      23.124  10.116  18.119  1.00  9.97           N
ATOM    238  CA  ALA A  69      21.758  10.389  17.692  1.00  9.00           C
ATOM    239  C   ALA A  69      21.298   9.369  16.658  1.00  9.48           C
ATOM    240  O   ALA A  69      20.146   8.939  16.668  1.00  9.28           O
ATOM    241  CB  ALA A  69      21.647  11.798  17.131  1.00  8.57           C
ATOM    242  N   ALA A  70      22.201   8.988  15.760  1.00  9.73           N
ATOM    243  CA  ALA A  70      21.878   7.986  14.752  1.00 10.58           C
ATOM    244  C   ALA A  70      21.731   6.603  15.383  1.00 12.45           C
ATOM    245  O   ALA A  70      20.833   5.840  15.027  1.00 14.36           O
ATOM    246  CB  ALA A  70      22.942   7.964  13.667  1.00 12.29           C
ATOM    247  N   ALA A  71      22.620   6.290  16.320  1.00 11.50           N
ATOM    248  CA  ALA A  71      22.609   4.998  17.000  1.00 12.25           C
ATOM    249  C   ALA A  71      21.494   4.864  18.036  1.00 12.23           C
ATOM    250  O   ALA A  71      20.573   4.063  17.870  1.00 15.23           O
ATOM    251  CB  ALA A  71      23.959   4.748  17.658  1.00 12.60           C
ATOM    252  N   ALA A  72      21.584   5.652  19.103  1.00 11.11           N
ATOM    253  CA  ALA A  72      20.753   5.446  20.287  1.00 12.65           C
ATOM    254  C   ALA A  72      19.374   6.098  20.201  1.00 13.10           C
ATOM    255  O   ALA A  72      18.580   5.996  21.136  1.00 16.44           O
ATOM    256  CB  ALA A  72      21.485   5.951  21.524  1.00 12.96           C
ATOM    257  N   ALA A  73      19.086   6.765  19.088  1.00 14.17           N
ATOM    258  CA  ALA A  73      17.781   7.392  18.913  1.00 15.12           C
ATOM    259  C   ALA A  73      17.104   6.920  17.631  1.00 17.70           C
ATOM    260  O   ALA A  73      17.664   6.124  16.877  1.00 20.10           O
ATOM    261  CB  ALA A  73      17.914   8.907  18.916  1.00 13.89           C
ATOM    262  N   ALA A  74      15.894   7.415  17.391  1.00 19.16           N
ATOM    263  CA  ALA A  74      15.122   7.024  16.218  1.00 21.44           C
ATOM    264  C   ALA A  74      15.369   7.973  15.051  1.00 23.40           C
ATOM    265  O   ALA A  74      15.195   9.185  15.176  1.00 24.90           O
ATOM    266  CB  ALA A  74      13.640   6.972  16.554  1.00 21.64           C
ATOM    267  N   GLY A  75      15.776   7.413  13.916  1.00 25.83           N
ATOM    268  CA  GLY A  75      16.036   8.202  12.727  1.00 26.40           C
ATOM    269  C   GLY A  75      14.778   8.470  11.925  1.00 27.84           C
ATOM    270  O   GLY A  75      13.687   8.041  12.302  1.00 29.68           O
TER
"""

tst_03_start_lines = """\
HELIX   13  13 SER A  466  TYR A  472  1                                   7
CRYST1  316.252  316.252  137.685  90.00  90.00  90.00 P 42
SCALE1      0.003162  0.000000  0.000000        0.00000
SCALE2      0.000000  0.003162  0.000000        0.00000
SCALE3      0.000000  0.000000  0.007263        0.00000
ATOM   3705  N   SER A 466     155.504 100.416 -57.508  1.00 73.99           N
ATOM   3706  CA  SER A 466     154.512 101.335 -58.064  1.00 70.64           C
ATOM   3707  CB  SER A 466     154.564 102.666 -57.311  1.00 81.39           C
ATOM   3708  OG  SER A 466     154.140 102.507 -55.969  1.00 74.75           O
ATOM   3709  C   SER A 466     154.658 101.598 -59.564  1.00 77.28           C
ATOM   3710  O   SER A 466     153.814 102.267 -60.156  1.00 76.04           O
ATOM   3711  N   ILE A 467     155.744 101.115 -60.162  1.00 88.34           N
ATOM   3712  CA  ILE A 467     155.931 101.173 -61.612  1.00 89.88           C
ATOM   3713  CB  ILE A 467     157.236 100.452 -62.029  1.00 81.96           C
ATOM   3714  CG1 ILE A 467     158.436 101.009 -61.259  1.00 71.84           C
ATOM   3715  CD1 ILE A 467     158.840 100.182 -60.054  1.00 55.56           C
ATOM   3716  CG2 ILE A 467     157.477 100.579 -63.527  1.00 90.27           C
ATOM   3717  C   ILE A 467     154.723 100.581 -62.351  1.00 79.45           C
ATOM   3718  O   ILE A 467     154.413 100.983 -63.474  1.00 70.14           O
ATOM   3719  N   VAL A 468     154.032  99.642 -61.709  1.00 84.86           N
ATOM   3720  CA  VAL A 468     152.853  98.999 -62.290  1.00 82.37           C
ATOM   3721  CB  VAL A 468     152.383  97.825 -61.409  1.00 45.76           C
ATOM   3722  CG1 VAL A 468     153.491  96.793 -61.264  1.00 58.97           C
ATOM   3723  CG2 VAL A 468     151.937  98.330 -60.045  1.00 48.02           C
ATOM   3724  C   VAL A 468     151.703  99.986 -62.509  1.00 99.02           C
ATOM   3725  O   VAL A 468     150.720  99.668 -63.180  1.00 92.98           O
ATOM   3726  N   ASN A 469     151.829 101.178 -61.935  1.00 94.97           N
ATOM   3727  CA  ASN A 469     150.817 102.225 -62.049  1.00 86.97           C
ATOM   3728  CB  ASN A 469     150.703 103.002 -60.735  1.00 92.20           C
ATOM   3729  CG  ASN A 469     150.184 102.149 -59.594  1.00 81.03           C
ATOM   3730  OD1 ASN A 469     150.837 102.009 -58.560  1.00 77.52           O
ATOM   3731  ND2 ASN A 469     149.000 101.575 -59.776  1.00 70.45           N
ATOM   3732  C   ASN A 469     151.105 103.193 -63.197  1.00 95.36           C
ATOM   3733  O   ASN A 469     150.432 104.215 -63.329  1.00103.42           O
ATOM   3734  N   ASP A 470     152.122 102.878 -63.998  1.00 97.78           N
ATOM   3735  CA  ASP A 470     152.569 103.730 -65.106  1.00 92.19           C
ATOM   3736  CB  ASP A 470     153.585 102.967 -65.962  1.00 87.01           C
ATOM   3737  CG  ASP A 470     154.148 103.806 -67.091  1.00 77.46           C
ATOM   3738  OD1 ASP A 470     154.285 105.034 -66.912  1.00 85.03           O
ATOM   3739  OD2 ASP A 470     154.454 103.235 -68.159  1.00 71.40           O
ATOM   3740  C   ASP A 470     151.421 104.230 -65.989  1.00 84.38           C
ATOM   3741  O   ASP A 470     151.094 105.417 -65.978  1.00 87.02           O
ATOM   3742  N   ILE A 471     150.820 103.312 -66.741  1.00 79.41           N
ATOM   3743  CA  ILE A 471     149.625 103.570 -67.552  1.00 79.85           C
ATOM   3744  CB  ILE A 471     148.379 103.743 -66.646  1.00 74.88           C
ATOM   3745  CG1 ILE A 471     148.466 102.822 -65.430  1.00 82.61           C
ATOM   3746  CD1 ILE A 471     148.426 101.349 -65.777  1.00 74.09           C
ATOM   3747  CG2 ILE A 471     147.104 103.383 -67.400  1.00 64.21           C
ATOM   3748  C   ILE A 471     149.781 104.769 -68.507  1.00 84.73           C
ATOM   3749  O   ILE A 471     150.776 104.874 -69.223  1.00 88.84           O
ATOM   3750  N   TYR A 472     148.794 105.664 -68.506  1.00 80.60           N
ATOM   3751  CA  TYR A 472     148.586 106.618 -69.597  1.00 75.53           C
ATOM   3752  CB  TYR A 472     147.081 106.733 -69.879  1.00 73.74           C
ATOM   3753  CG  TYR A 472     146.738 107.485 -71.147  1.00 67.57           C
ATOM   3754  CD1 TYR A 472     147.138 107.010 -72.389  1.00 64.47           C
ATOM   3755  CE1 TYR A 472     146.829 107.695 -73.548  1.00 69.28           C
ATOM   3756  CZ  TYR A 472     146.109 108.869 -73.475  1.00 73.07           C
ATOM   3757  OH  TYR A 472     145.797 109.553 -74.627  1.00 67.60           O
ATOM   3758  CE2 TYR A 472     145.698 109.360 -72.254  1.00 73.64           C
ATOM   3759  CD2 TYR A 472     146.012 108.669 -71.100  1.00 67.13           C
ATOM   3760  C   TYR A 472     149.180 108.017 -69.381  1.00 52.97           C
ATOM   3761  O   TYR A 472     148.984 108.907 -70.208  1.00 41.97           O
"""

tst_03_answer_lines = """\
HELIX   13  13 SER A  466  TYR A  472  1                                   7
CRYST1  316.252  316.252  137.685  90.00  90.00  90.00 P 42
SCALE1      0.003162  0.000000  0.000000        0.00000
SCALE2      0.000000  0.003162  0.000000        0.00000
SCALE3      0.000000  0.000000  0.007263        0.00000
ATOM   3705  N   SER A 466     153.673 100.477 -58.554  1.00 73.99           N
ATOM   3706  CA  SER A 466     154.083 101.806 -58.991  1.00 70.64           C
ATOM   3707  CB  SER A 466     155.335 102.256 -58.236  1.00 81.39           C
ATOM   3708  OG  SER A 466     155.101 102.297 -56.839  1.00 74.75           O
ATOM   3709  C   SER A 466     154.337 101.838 -60.495  1.00 77.28           C
ATOM   3710  O   SER A 466     154.018 102.821 -61.168  1.00 76.04           O
ATOM   3711  N   ILE A 467     154.909 100.750 -61.018  1.00 88.34           N
ATOM   3712  CA  ILE A 467     155.217 100.681 -62.445  1.00 89.88           C
ATOM   3713  CB  ILE A 467     156.102  99.451 -62.744  1.00 81.96           C
ATOM   3714  CG1 ILE A 467     157.514  99.642 -62.178  1.00 71.84           C
ATOM   3715  CD1 ILE A 467     157.682  99.178 -60.744  1.00 55.56           C
ATOM   3716  CG2 ILE A 467     156.163  99.180 -64.241  1.00 90.27           C
ATOM   3717  C   ILE A 467     153.943 100.665 -63.275  1.00 79.45           C
ATOM   3718  O   ILE A 467     153.849 101.356 -64.299  1.00 70.14           O
ATOM   3719  N   VAL A 468     152.932  99.908 -62.842  1.00 84.86           N
ATOM   3720  CA  VAL A 468     151.664  99.866 -63.556  1.00 82.37           C
ATOM   3721  CB  VAL A 468     150.764  98.743 -62.992  1.00 45.76           C
ATOM   3722  CG1 VAL A 468     151.285  97.382 -63.424  1.00 58.97           C
ATOM   3723  CG2 VAL A 468     150.691  98.825 -61.473  1.00 48.02           C
ATOM   3724  C   VAL A 468     150.943 101.204 -63.517  1.00 99.02           C
ATOM   3725  O   VAL A 468     150.352 101.616 -64.524  1.00 92.98           O
ATOM   3726  N   ASN A 469     150.995 101.905 -62.387  1.00 94.97           N
ATOM   3727  CA  ASN A 469     150.441 103.245 -62.276  1.00 86.97           C
ATOM   3728  CB  ASN A 469     150.475 103.714 -60.819  1.00 92.20           C
ATOM   3729  CG  ASN A 469     149.672 102.817 -59.898  1.00 81.03           C
ATOM   3730  OD1 ASN A 469     150.210 102.231 -58.959  1.00 77.52           O
ATOM   3731  ND2 ASN A 469     148.375 102.705 -60.163  1.00 70.45           N
ATOM   3732  C   ASN A 469     151.179 104.238 -63.160  1.00 95.36           C
ATOM   3733  O   ASN A 469     150.554 105.157 -63.698  1.00103.42           O
ATOM   3734  N   ASP A 470     152.492 104.072 -63.319  1.00 97.78           N
ATOM   3735  CA  ASP A 470     153.266 104.909 -64.225  1.00 92.19           C
ATOM   3736  CB  ASP A 470     154.766 104.673 -64.031  1.00 87.01           C
ATOM   3737  CG  ASP A 470     155.614 105.533 -64.948  1.00 77.46           C
ATOM   3738  OD1 ASP A 470     155.945 106.672 -64.559  1.00 85.03           O
ATOM   3739  OD2 ASP A 470     155.951 105.068 -66.057  1.00 71.40           O
ATOM   3740  C   ASP A 470     152.861 104.627 -65.667  1.00 84.38           C
ATOM   3741  O   ASP A 470     152.824 105.541 -66.497  1.00 87.02           O
ATOM   3742  N   ILE A 471     152.555 103.366 -65.972  1.00 79.41           N
ATOM   3743  CA  ILE A 471     152.125 102.979 -67.311  1.00 79.85           C
ATOM   3744  CB  ILE A 471     152.063 101.447 -67.459  1.00 74.88           C
ATOM   3745  CG1 ILE A 471     153.470 100.848 -67.406  1.00 82.61           C
ATOM   3746  CD1 ILE A 471     154.390 101.349 -68.499  1.00 74.09           C
ATOM   3747  CG2 ILE A 471     151.369 101.054 -68.755  1.00 64.21           C
ATOM   3748  C   ILE A 471     150.774 103.618 -67.603  1.00 84.73           C
ATOM   3749  O   ILE A 471     150.523 104.086 -68.720  1.00 88.84           O
ATOM   3750  N   TYR A 472     149.901 103.657 -66.600  1.00 80.60           N
ATOM   3751  CA  TYR A 472     148.594 104.286 -66.764  1.00 75.53           C
ATOM   3752  CB  TYR A 472     147.695 103.975 -65.565  1.00 73.74           C
ATOM   3753  CG  TYR A 472     146.314 104.587 -65.652  1.00 67.57           C
ATOM   3754  CD1 TYR A 472     145.310 103.982 -66.397  1.00 64.47           C
ATOM   3755  CE1 TYR A 472     144.047 104.537 -66.478  1.00 69.28           C
ATOM   3756  CZ  TYR A 472     143.773 105.710 -65.807  1.00 73.07           C
ATOM   3757  OH  TYR A 472     142.517 106.266 -65.885  1.00 67.60           O
ATOM   3758  CE2 TYR A 472     144.752 106.329 -65.059  1.00 73.64           C
ATOM   3759  CD2 TYR A 472     146.012 105.767 -64.983  1.00 67.13           C
ATOM   3760  C   TYR A 472     148.731 105.797 -66.942  1.00 52.97           C
ATOM   3761  O   TYR A 472     148.740 106.303 -68.066  1.00 41.97           O
TER
END
"""

tst_04_start_lines = """\
ATOM      1  N   ALA A  21       8.035  20.299   4.150  1.00 33.96           N
ATOM      2  CA  ALA A  21       9.085  20.780   5.040  1.00 32.69           C
ATOM      3  C   ALA A  21       9.114  19.980   6.338  1.00 32.55           C
ATOM      4  O   ALA A  21       8.257  20.152   7.204  1.00 33.56           O
ATOM      5  CB  ALA A  21       8.893  22.260   5.334  1.00 33.18           C
ATOM      6  N   UNK A  22      10.106  19.104   6.465  1.00 31.24           N
ATOM      7  CA  UNK A  22      10.248  18.275   7.655  1.00 30.10           C
ATOM      8  C   UNK A  22      11.377  18.783   8.546  1.00 29.32           C
ATOM      9  O   UNK A  22      12.549  18.724   8.173  1.00 30.19           O
ATOM     10  CB  UNK A  22      10.491  16.826   7.266  1.00 30.34           C
ATOM     11  CG  UNK A  22      10.006  16.721   7.661  1.00 20.00           C
ATOM     12  N   ALA A  23      11.017  19.283   9.723  1.00 27.76           N
ATOM     13  CA  ALA A  23      11.998  19.805  10.666  1.00 26.26           C
ATOM     14  C   ALA A  23      11.854  19.144  12.033  1.00 23.38           C
ATOM     15  O   ALA A  23      11.027  18.251  12.217  1.00 25.31           O
ATOM     16  CB  ALA A  23      11.863  21.315  10.790  1.00 27.05           C
ATOM     17  N   ALA A  24      12.663  19.590  12.988  1.00 19.15           N
ATOM     18  CA  ALA A  24      12.633  19.039  14.337  1.00 17.40           C
ATOM     19  C   ALA A  24      11.922  19.980  15.304  1.00 15.24           C
ATOM     20  O   ALA A  24      12.393  21.086  15.567  1.00 15.15           O
ATOM     21  CB  ALA A  24      14.044  18.750  14.822  1.00 16.09           C
"""

tst_04_answer_lines = """\
ATOM      1  N   ALA A  21       9.494  21.954   5.991  1.00 33.96           N
ATOM      2  CA  ALA A  21       8.437  20.970   5.799  1.00 32.69           C
ATOM      3  C   ALA A  21       8.598  19.797   6.760  1.00 32.55           C
ATOM      4  O   ALA A  21       7.615  19.270   7.279  1.00 33.56           O
ATOM      5  CB  ALA A  21       8.426  20.479   4.359  1.00 33.18           C
ATOM      6  N   UNK A  22       9.844  19.397   6.998  1.00 31.24           N
ATOM      7  CA  UNK A  22      10.109  18.239   7.860  1.00 30.10           C
ATOM      8  C   UNK A  22      11.539  18.157   8.509  1.00 29.32           C
ATOM      9  O   UNK A  22      12.289  17.203   8.182  1.00 30.19           O
ATOM     10  CB  UNK A  22       9.871  16.955   7.044  1.00 30.34           C
ATOM     11  CG  UNK A  22       8.817  16.061   7.670  1.00 20.00           C
ATOM     12  N   ALA A  23      11.898  19.102   9.374  1.00 27.76           N
ATOM     13  CA  ALA A  23      13.023  18.871  10.274  1.00 26.26           C
ATOM     14  C   ALA A  23      12.730  19.317  11.704  1.00 23.38           C
ATOM     15  O   ALA A  23      13.123  18.649  12.661  1.00 25.31           O
ATOM     16  CB  ALA A  23      14.265  19.579   9.750  1.00 27.05           C
ATOM     17  N   ALA A  24      12.039  20.442  11.846  1.00 19.15           N
ATOM     18  CA  ALA A  24      11.719  20.983  13.163  1.00 17.40           C
ATOM     19  C   ALA A  24      10.743  20.086  13.915  1.00 15.24           C
ATOM     20  O   ALA A  24      10.862  19.903  15.126  1.00 15.15           O
ATOM     21  CB  ALA A  24      11.152  22.389  13.032  1.00 16.09           C
TER
"""

def get_distances(h, n_neighbours=None):
  d = flex.double()
  for i, a in enumerate(h.atoms()):
    #for j in range(i, min(len(h.atoms()), i+10)):
    if n_neighbours is not None:
      r = range(i, min(len(h.atoms()), i+10))
    else:
      r = range(i, len(h.atoms()))
    for j in r:
      d.append(a.distance(h.atoms()[j]))
  return d


def exercise_pure_polyala_alpha(prefix="tst_2_ex_ppa"):
  """
  Simple polyala one helix case.
  """
  h_records = """\
HELIX    1   1 ALA A    1  ALA A   20  1                                  20
"""
  import sys # import dependency
  h = ssb.secondary_structure_from_sequence(ssb.alpha_helix_str,"A"*20)
  # h.write_pdb_file(file_name=prefix+'h0.pdb')
  d1 = get_distances(h)
  ann = ioss.annotation.from_records(records=h_records.split('\n'))
  pdb_inp = iotbx.pdb.input(source_info=None,
        lines=h.as_pdb_string())
  test_h = pdb_inp.construct_hierarchy()
  for i in range(3):
    rm = ssb.substitute_ss(
      real_h=test_h,
      xray_structure=pdb_inp.xray_structure_simple(),
      ss_annotation=ann,
      # log=sys.stdout,
      # verbose=True
      )
  # test_h.write_pdb_file(file_name=prefix+'h1.pdb')
  d2 = get_distances(test_h)
  dist = abs(d2-d1)
  dmmm = abs(d2-d1).min_max_mean().as_tuple()
  # print "minmaxmean sd", dmmm, abs(d2-d1).standard_deviation_of_the_sample()
  assert dmmm[1] < 0.5
  assert dmmm[2] < 0.05
  assert dist.standard_deviation_of_the_sample() < 0.05

def exercise_00(prefix="tst_2_exercise_00"):
  """
  2 alpha helices and loop between them
  """
  h_records = """\
HELIX    1   1 PRO A    3  ALA A   21  1                                  19
HELIX    2   2 ARG A   23  GLN A   44  1                                  22
"""
  pdb_inp = iotbx.pdb.input(source_info=None,
    lines=tst_00_start_lines)
  ann = ioss.annotation.from_records(records=h_records.split('\n'))
  h = pdb_inp.construct_hierarchy()
  d1 = get_distances(h)
  # h.write_pdb_file(file_name=prefix+'_initial.pdb')
  for i in range(1):
    rm = ssb.substitute_ss(
      real_h=h,
      xray_structure=pdb_inp.xray_structure_simple(),
      ss_annotation=ann)
  d2 = get_distances(h)
  # h.write_pdb_file(file_name=prefix+'_result.pdb')
  dist = abs(d2-d1)
  dmmm = abs(d2-d1).min_max_mean().as_tuple()
  # print "minmaxmean sd", dmmm, abs(d2-d1).standard_deviation_of_the_sample()
  assert dmmm[1] < 0.8
  assert dmmm[2] < 0.2
  assert dist.standard_deviation_of_the_sample() < 0.2

def exercise_01(prefix="tst_2_exercise_01"):
  """
  Similar to exercise_00. + Side chains.
  """
  h_records = """\
HELIX    1   1 PRO A    3  ALA A   21  1                                  19
HELIX    2   2 ARG A   23  GLN A   44  1                                  22
"""
  pdb_inp = iotbx.pdb.input(source_info=None,
      lines=tst_01_start_lines)
  ann = ioss.annotation.from_records(records=h_records.split('\n'))
  h = pdb_inp.construct_hierarchy()
  d1 = get_distances(h, n_neighbours=20)
  h.write_pdb_file(file_name=prefix+'_initial.pdb')
  for i in range(1):
    rm = ssb.substitute_ss(
      real_h=h,
      xray_structure=pdb_inp.xray_structure_simple(),
      ss_annotation=ann)
  d2 = get_distances(h, n_neighbours=20)
  h.write_pdb_file(file_name=prefix+'_result.pdb')
  dist = abs(d2-d1)
  dmmm = abs(d2-d1).min_max_mean().as_tuple()
  # print "minmaxmean sd", dmmm, abs(d2-d1).standard_deviation_of_the_sample()
  # assert dmmm[1] < 0.8
  assert dmmm[2] < 0.2
  assert dist.standard_deviation_of_the_sample() < 0.2

def exercise_02(prefix="tst_2_exercise_02"):
  """
  Similar to exercise_01. +beta sheets.
  """
  h_records = """\
HELIX    1   1 ARG A   65  ARG A   71  1                                   7
SHEET    1  AA 2 PHE A  42  CYS A  47  0
SHEET    2  AA 2 CYS A  52  GLY A  57 -1  O  LYS A  53   N  TYR A  46
"""
  pdb_inp = iotbx.pdb.input(source_info=None,
      lines=tst_02_start_lines)
  ann = ioss.annotation.from_records(records=h_records.split('\n'))
  h = pdb_inp.construct_hierarchy()
  d1 = get_distances(h, n_neighbours=20)
  h.write_pdb_file(file_name=prefix+'_initial.pdb')
  for i in range(3):
    rm = ssb.substitute_ss(
      real_h=h,
      xray_structure=pdb_inp.xray_structure_simple(),
      ss_annotation=ann)
  d2 = get_distances(h, n_neighbours=20)
  h.write_pdb_file(file_name=prefix+'_result.pdb')
  dist = abs(d2-d1)
  dmmm = abs(d2-d1).min_max_mean().as_tuple()
  # print "minmaxmean sd", dmmm, abs(d2-d1).standard_deviation_of_the_sample()
  #assert dmmm[1] < 0.8
  assert dmmm[2] < 0.1
  assert dist.standard_deviation_of_the_sample() < 0.1

def exercise_03(prefix="tst_2_exercise_03"):
  """
  Mixed order of atoms in pdb file
  """
  h_records = """\
HELIX   13  13 SER A  466  TYR A  472  1                                   7
  """
  pdb_inp = iotbx.pdb.input(source_info=None, lines=tst_03_start_lines)
  ann = ann = ioss.annotation.from_records(records=h_records.split('\n'))
  h = pdb_inp.construct_hierarchy()
  # h.write_pdb_file(file_name="start.pdb")
  rm = ssb.substitute_ss(
      real_h=h,
      xray_structure=pdb_inp.xray_structure_simple(),
      ss_annotation=ann)
  # h.write_pdb_file(file_name="result.pdb")
  d1 = get_distances(h, 5)
  answer_h = iotbx.pdb.input(
      source_info=None,
      lines=tst_03_answer_lines).construct_hierarchy()
  # answer_h.write_pdb_file(file_name="answer.pdb")
  d2 = get_distances(answer_h, 5)
  dist = abs(d2-d1)
  dmmm = abs(d2-d1).min_max_mean().as_tuple()
  assert dmmm[2] < 0.1

def exercise_04(prefix="tst_2_exercise_04"):
  """
  Unknown residue in SS structure
  """
  h_records = """\
HELIX    1  21 ALA A   21  ALA A   24  1                                  5
"""
  pdb_inp = iotbx.pdb.input(source_info=None, lines=tst_04_start_lines)
  ann = ann = ioss.annotation.from_records(records=h_records.split('\n'))
  h = pdb_inp.construct_hierarchy()
  h.write_pdb_file(file_name="%s_start.pdb" % prefix)
  rm = ssb.substitute_ss(
      real_h=h,
      xray_structure=pdb_inp.xray_structure_simple(),
      ss_annotation=ann)
  h.write_pdb_file(file_name="%s_result.pdb" % prefix)
  d1 = get_distances(h, 5)
  answer_h = iotbx.pdb.input(
      source_info=None,
      lines=tst_04_answer_lines).construct_hierarchy()
  # answer_h.write_pdb_file(file_name="answer.pdb")
  d2 = get_distances(answer_h, 5)
  dist = abs(d2-d1)
  dmmm = abs(d2-d1).min_max_mean().as_tuple()
  print dmmm
  assert dmmm[2] < 0.1


def exercise():
  """  Crashes on chevy, works on marbles. """
  exercise_pure_polyala_alpha()
  exercise_00()
  exercise_01()
  exercise_02()
  exercise_03()
  exercise_04()
  print "OK"

if (__name__ == "__main__"):
  exercise()
